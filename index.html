
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8" />
        <title>阿杰之家</title>
        <meta name="author" content="ajiehome" />
        <meta name="description" content="山有扶苏，隰有荷华" />
        <meta name="keywords" content="ajiehome,阿杰之家" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <link rel="icon" href="https://static-argvchs.netlify.app/images/favicon.png" />
        <script src="https://static-argvchs.netlify.app/libs/vue/3.2.47/vue.global.prod.min.js"></script>
<link rel="preconnect" href="https://static-argvchs.netlify.app" crossorigin />
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/font-awesome/6.3.0/css/all.min.css" />
<link rel="stylesheet" href="https://static-argvchs.netlify.app/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://static-argvchs.netlify.app/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://static-argvchs.netlify.app/libs/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/katex.min.js"></script>
<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<script src="https://static-argvchs.netlify.app/libs/animejs/3.2.1/anime.min.js"></script>
<link rel="stylesheet" href="/css/main.css" />

    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
                <div id="loading" v-show="loading">
                    <div id="loading-circle">
                        <h2>LOADING</h2>
                        <p>加载过慢请开启缓存 浏览器默认开启</p>
                        <img src="/images/loading.gif" />
                    </div>
                </div>
            </transition>
            <nav id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <div id="desktop-menu">
        <a class="title" href="/">
            <span>阿杰之家</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;阿杰之家</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </div>
</nav>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

            <transition name="into">
                <div id="main" v-show="!loading">
                    <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="https://static-argvchs.netlify.app/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>阿杰之家</h1>
                <h3>山有扶苏，隰有荷华</h3>
                <h5>山有扶苏，隰有荷华</h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap"  ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/">
        <h2 class="post-title">C++内存分配</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/C-%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                C++基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="内存分配"><a href="#内存分配" class="headerlink" title="内存分配"></a>内存分配</h1><p>内存分配与释放：</p>
<p> <code>new</code>：内存分配</p>
<p><code>delete/delete[]</code>：内存释放</p>
<p>程序代码也是存在于内存中</p>
<p>堆空间与栈空间是数据空间</p>
<p>堆空间从低往上走</p>
<p>栈空间从高往低走</p>
<h2 id="深拷贝与浅拷贝"><a href="#深拷贝与浅拷贝" class="headerlink" title="深拷贝与浅拷贝"></a>深拷贝与浅拷贝</h2><p>浅拷贝：只拷贝栈内存，也就是说只拷贝了栈内存中的堆内存的地址，最终拷贝的两个对象指向同一个堆内存地址</p>
<p>深拷贝：拷贝栈内存数据，但是栈内存中存储堆内存地址部分却是重新申请的堆内存的空间地址，堆内存只拷贝数据内容，而内存空间是重新申请生成的</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">
        <h2 class="post-title">C++基础语法</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/C-%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                C++基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="C-基础语法"><a href="#C-基础语法" class="headerlink" title="C++基础语法"></a>C++基础语法</h1><p><strong>构造函数与析构函数</strong></p>
<ol>
<li>一个类中析构函数只能有一个，而构造函数可以有很多个</li>
<li>析构函数没有函数参数、没有返回值、没有返回类型</li>
<li>由于没有函数参数，所以不能被重载</li>
<li>构造函数在类的构建时调用，析构函数在类的声明周期结束时调用</li>
</ol>
<p>Test.h文件</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#ifdef _TEST_H_ 
#defind _TEST_H_ 

#include &lt;iostream&gt;
using namespace sth
namespace test&#123;
    class Test&#123;
        public:
            Test()&#123;
                this.sex&#x3D;0;
                this.sex&#x3D;0L;
            &#125; &#x2F;&#x2F;构造函数
            ~Test()&#123;&#125; &#x2F;&#x2F;析构函数
        public:
            void setSex(int sex); &#x2F;&#x2F;公共方法
            void setPhone(long phone); 
            int getSex();
            long getPhone();
        private:
            int sex; &#x2F;&#x2F;私有属性
            long phone;
    &#125;;
&#125; &#x2F;&#x2F;namespace
#endif &#x2F;&#x2F;_TEST_H_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Test.cpp文件</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &quot;Test.h&quot;

namespace test&#123;
    void Test::setSex(int s)&#123;
        sex &#x3D; s;
    &#125;
    void Test::setPhone(long p)&#123;
        phone &#x3D; p;
    &#125;
    int Test::getSex()&#123;
        return sex;
    &#125;
    long Test::getPhone()&#123;
        return phone;
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>名存空间</strong></p>
<p><code>using namespace &#39;Name&#39;</code>：选择名存空间</p>
<p><code>namespace &#39;Name&#39;</code>：创建名存空间关键字</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E8%AF%AD%E6%B3%95_%E7%BB%A7%E6%89%BF/">
        <h2 class="post-title">C++语法_继承</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/C-%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                C++基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h1><p><strong>Fight.h</strong>文件</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#ifdel _CLIENT_TEST_H_
#default _CLIENT_TEST_H_
#include &lt;iostream&gt;
#include &quot;Test.h&quot;

namespace fight&#123;
    class Fight: public Test&#123;
      public:
        Figint()&#123;
            wea &#x3D; 1;
        &#125;
        ~Fight()&#123;

        &#125;
        private:
            int wea;
        public:
            void setWea(int w);
            int getWea();
    &#125;;
&#125; &#x2F;&#x2F;namespace
#endif &#x2F;&#x2F; _CLIENT_FIGht_H_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Feight.cpp</strong>文件</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &quot;Fight.h&quot;

namespace fight&#123;
    void Fight::setWea(w)&#123;
        wea &#x3D; w;
    &#125;
    int Fight::getWea()&#123;
        return wea;
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>调用</strong></p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;iostream&gt;
#include &quot;Fight.h&quot;

int main(int argc, char* agev[])&#123;
    fight::Fight
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E8%AF%AD%E6%B3%95_%E7%BB%A7%E6%89%BF/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka%E5%AE%89%E8%A3%85/">
        <h2 class="post-title">Kafka安装</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                中间件
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <p>首先下载Kafka的二进制包，以及Kafka-Manager Cmak工具</p>
<p><a target="_blank" rel="noopener" href="https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz">Kafka</a>(<a target="_blank" rel="noopener" href="https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz">https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz</a>)</p>
<p><a target="_blank" rel="noopener" href="https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip">Cmak</a>(<a target="_blank" rel="noopener" href="https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip">https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip</a>)</p>
<p>解压Kafka到<code>/opt</code>目录shell</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> kafka_2.13-3.3.1.tgz <span class="token parameter variable">-C</span> /opt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>解压Cmak到<code>/opt</code>目录</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">unzip</span> cmak-3.0.0.6 <span class="token parameter variable">-C</span> /opt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>修改cmak的application.properties<code>/opt/cmak-3.0.0.6/conf/application.properties</code>的如下信息</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># The address the socket server listens on. If not configured, the host name will be equal to the value of</span>
<span class="token comment"># java.net.InetAddress.getCanonicalHostName(), with PLAINTEXT listener name, and port 9092.</span>
<span class="token comment">#   FORMAT:</span>
<span class="token comment">#     listeners = listener_name://host_name:port</span>
<span class="token comment">#   EXAMPLE:</span>
<span class="token comment">#     listeners = PLAINTEXT://your.host.name:9092</span>
<span class="token comment">#listeners=PLAINTEXT://:9092</span>

<span class="token assign-left variable">listeners</span><span class="token operator">=</span>PLAINTEXT://10.254.0.2:9092

<span class="token comment"># Listener name, hostname and port the broker will advertise to clients.</span>
<span class="token comment"># If not set, it uses the value for "listeners".</span>
<span class="token comment">#advertised.listeners=PLAINTEXT://your.host.name:9092</span>
<span class="token assign-left variable">advertised.listeners</span><span class="token operator">=</span>PLAINTEXT://10.254.0.2:9092

<span class="token comment"># Settings prefixed with 'kafka-manager.' will be deprecated, use 'cmak.' instead.</span>
<span class="token comment"># https://github.com/yahoo/CMAK/issues/713</span>
kafka-manager.zkhosts<span class="token operator">=</span><span class="token string">"kafka-manager-zookeeper:2181"</span>
<span class="token comment">#kafka-manager.zkhosts=$&#123;?ZK_HOSTS&#125;</span>
kafka-manager.zkhosts<span class="token operator">=</span><span class="token string">"10.254.0.2:2181"</span>
<span class="token assign-left variable">cmak.zkhosts</span><span class="token operator">=</span><span class="token string">"kafka-manager-zookeeper:2181"</span>
<span class="token comment">#cmak.zkhosts=$&#123;?ZK_HOSTS&#125;</span>
<span class="token assign-left variable">cmak.zkhosts</span><span class="token operator">=</span><span class="token string">"10.254.0.2:2181"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>构建如下脚本，一键启动Kafka所需要的Zookeeper服务、Kafka服务以及Cmak管理工具</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">option</span><span class="token operator">=</span><span class="token variable">$1</span>

<span class="token builtin class-name">echo</span> <span class="token string">"option <span class="token variable">$option</span>"</span>

<span class="token keyword">case</span> <span class="token variable">$option</span> <span class="token keyword">in</span> 

  <span class="token string">'start'</span><span class="token punctuation">)</span>

    <span class="token comment"># create kafka catalogue</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">'/root/kafka'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka catalogue exists'</span>
    <span class="token keyword">else</span> 
      <span class="token function">mkdir</span> /root/kafka
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka catalogue success'</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># create kafka log catalogue</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">"/root/kafka/log"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka log catalogue exists'</span>
    <span class="token keyword">else</span>
      <span class="token function">mkdir</span> /root/kafka/log
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka log catalogue success'</span>
    <span class="token keyword">fi</span>
    <span class="token comment">#  create kafka pid catalogue</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">'/root/kafka/pid'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka pid catalogue exists'</span>
    <span class="token keyword">else</span>
      <span class="token function">mkdir</span> /root/kafka/pid
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka pid catalogue success'</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># creare kafka zk log file </span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/log/zk.log'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka zk log file already exists'</span>
    <span class="token keyword">else</span> 
      <span class="token function">touch</span> /root/kafka/log/zk.log
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka zk log file success'</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># create zk pid file </span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/pid/zk-pid'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka zk pid file already exists'</span>
    <span class="token keyword">else</span>
      <span class="token function">touch</span> /root/kafka/pid/zk-pid
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka zk pid file success'</span>
    <span class="token keyword">fi</span>

    <span class="token function">nohup</span>  /opt/kafka_2.13-3.3.1/bin/zookeeper-server-start.sh /opt/kafka_2.13-3.3.1/config/zookeeper.properties <span class="token operator">></span> /root/kafka/log/zk.log <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span> <span class="token operator">></span> /root/kafka/pid/zk-pid
    <span class="token builtin class-name">echo</span> <span class="token string">'loading 1 minute ......'</span> 
    <span class="token function">sleep</span> 1m

    <span class="token comment"># create kafka server log file</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/log/kafka.log'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka server log file exists'</span>
    <span class="token keyword">else</span> 
      <span class="token function">touch</span> /root/kafka/log/kafka.log
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka server log file success'</span>
    <span class="token keyword">fi</span>
    <span class="token comment"># create kafka pid pid file</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/pid/kafka-pid'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">'kafka server pid file exists'</span>
    <span class="token keyword">else</span>
      <span class="token function">touch</span> /root/kafka/pid/kafka-pid
      <span class="token builtin class-name">echo</span> <span class="token string">'create kafka server pid file success'</span>
    <span class="token keyword">fi</span>

    <span class="token builtin class-name">export</span> <span class="token assign-left variable">JMX_PORT</span><span class="token operator">=</span><span class="token number">9999</span>

    <span class="token function">nohup</span> /opt/kafka_2.13-3.3.1/bin/kafka-server-start.sh /opt/kafka_2.13-3.3.1/config/server.properties <span class="token operator">></span> /root/kafka/log/kafka.log <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span> <span class="token operator">></span> /root/kafka/pid/kafka-pid


    <span class="token comment"># create kafka-manager cmak log file</span>
      <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/log/cmak.log'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">'kafka manager cmak log file exists'</span>
      <span class="token keyword">else</span>
        <span class="token function">touch</span> /root/kafka/log/cmak.log
        <span class="token builtin class-name">echo</span> <span class="token string">'create kafka manager cmak log file success'</span>
      <span class="token keyword">fi</span>
    <span class="token comment"># create kafka-manager cmak pid file</span>
     <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">'/root/kafka/pid/cmak-pid'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
       <span class="token builtin class-name">echo</span> <span class="token string">'kafka manager cmak pid file exists'</span>
     <span class="token keyword">else</span> 
       <span class="token function">touch</span> /root/kafka/pid/cmak-pid
       <span class="token builtin class-name">echo</span> <span class="token string">'create kafka manager cmak pid file success'</span>
     <span class="token keyword">fi</span>

    <span class="token function">nohup</span> <span class="token function">bash</span> /opt/cmak-3.0.0.6/bin/cmak <span class="token operator">></span> /root/kafka/log/cmak.log <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$!</span> <span class="token operator">></span> /root/kafka/pid/cmak-pid

    <span class="token builtin class-name">echo</span> <span class="token string">'loading 1 minute ......'</span>
    <span class="token function">sleep</span> 1m
    <span class="token builtin class-name">echo</span> <span class="token string">'all server start success'</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>

  <span class="token string">'stop'</span><span class="token punctuation">)</span>
    <span class="token assign-left variable">zk_pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /root/kafka/pid/zk-pid<span class="token variable">)</span></span>
    <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$zk_pid</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'kill zookeeper server success'</span>

    <span class="token assign-left variable">kafka_pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /root/kafka/pid/kafka-pid<span class="token variable">)</span></span>
    <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$kafka_pid</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'kill kafka server success'</span>

    <span class="token assign-left variable">cmak_pid</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /root/kafka/pid/cmak-pid<span class="token variable">)</span></span>
    <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$cmak_pid</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'kill kafka manager cmak success'</span>     
    <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /opt/cmak-3.0.0.6/RUNNING_PID
  <span class="token punctuation">;</span><span class="token punctuation">;</span>

  *<span class="token punctuation">)</span>
    <span class="token builtin class-name">echo</span> <span class="token string">'option error'</span>
  <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka%E5%AE%89%E8%A3%85/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E4%B8%8ESystemd/">
        <h2 class="post-title">RocketMQ与Systemd</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                中间件
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="RocketMQ与Systemd"><a href="#RocketMQ与Systemd" class="headerlink" title="RocketMQ与Systemd"></a>RocketMQ与Systemd</h1><p>RocketMQ的安装比较简单，只需要提供了JAVA_HOME环境，之后运行对于的脚本即可，所以这里主要介绍的RocketMQ与Systemd的配置，结合Shell脚本，一次性的启用namsesrv和borker以及web管理工具<code>rocketmq-dashboard</code></p>
<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>Java: openjdk-11</p>
<p>RocketMQ: <code>rocketmq-all-5.0.0-bin-release.zip</code><a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/5.0.0/rocketmq-all-5.0.0-bin-release.zip">下载</a></p>
<p>RocketMQ Dashboard: <code>rocketmq-dashboard-rocketmq-dashboard-1.0.0.tar.gz</code> <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq-dashboard">源码地址,该项目需要自己编译成jar包</a></p>
<p>在下载了RocketMQ的二进制包之后，解压到指定位置，而后配置对于的<code>namesrv</code>和<code>borker</code>服务，systemd的服务配置在<code>/usr/lib/systemd/system/</code>或者<code>/etc/systemd/system/</code>目录下</p>
<p>rmq_namesrv.service</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>rocketmq namesrv
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/rocketmq-all-5.0.0-bin-release/bin/mqnamesrv
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>//opt/rocketmq-all-5.0.0-bin-release/bin/mqshutdown namesrv

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>mulitiple-rmq-namesrv.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>rmq_borker.service</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>rocketmq broker
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/rocketmq-all-5.0.0-bin-release/bin/mqbroker <span class="token parameter variable">-n</span> localhost:9876 --enable-proxy
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/opt/rocketmq-all-5.0.0-bin-release/bin/mqshutdown broker

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multiple-rmq-broker.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在配置了这两个服务之后，即可通过systemctl start&#x2F;stop&#x2F;restart来执行服务了，由于每次都需要启动<code>namesrv</code>和<code>borker</code>服务还有web管理工具过于麻烦，所以引入<code>shell</code>脚本进行处理</p>
<p>rocketmq.shell</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">instruct</span><span class="token operator">=</span><span class="token variable">$1</span>

<span class="token builtin class-name">echo</span> <span class="token variable">$instruct</span>

<span class="token keyword">case</span> <span class="token variable">$instruct</span> <span class="token keyword">in</span>
 <span class="token string">'start'</span><span class="token punctuation">)</span>
   systemctl start rmq_namesrv
   systemctl start rmq_borker
   <span class="token builtin class-name">export</span> <span class="token assign-left variable">NAMSESRV_ADDR</span><span class="token operator">=</span>localhost:9876
   <span class="token function">nohup</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> /opt/rocketmq-dashboard-rocketmq-dashboard-1.0.0/target/rocketmq-dashboard-1.0.0.jar <span class="token operator">></span> /root/rocketmq-dashboard.log <span class="token operator">&amp;</span>
   <span class="token builtin class-name">echo</span> <span class="token variable">$!</span> <span class="token operator">></span> /root/rmq-d-pid
   <span class="token builtin class-name">echo</span> <span class="token string">"RocketMQ Start SUCCESS PID: "</span> + <span class="token variable">$!</span>
 <span class="token punctuation">;</span><span class="token punctuation">;</span>

 <span class="token string">'stop'</span><span class="token punctuation">)</span>
   systemctl stop rmq_namesrv
   systemctl stop rmq_borker
   <span class="token assign-left variable">PID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /root/rmq-d-pid<span class="token variable">)</span></span>
   <span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$&#123;PID&#125;</span>
   <span class="token builtin class-name">echo</span> <span class="token string">"RocketMQ Stop SUCCESS"</span>
 <span class="token punctuation">;</span><span class="token punctuation">;</span>

 *<span class="token punctuation">)</span>
   <span class="token builtin class-name">echo</span> <span class="token string">"Input instruct error"</span>
 <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以通过执行该shell脚本对RocketMQ进行启动和关闭</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E4%B8%8ESystemd/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E5%85%B3%E7%B3%BB%E6%A2%B3%E7%90%86/">
        <h2 class="post-title">RocketMQ关系梳理</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                中间件
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="RocketMQ关系梳理"><a href="#RocketMQ关系梳理" class="headerlink" title="RocketMQ关系梳理"></a>RocketMQ关系梳理</h1><p>对于RocketMQ的生产者、消息、消费者、消费者分组、主题、队列、订阅关系的梳理</p>
<p>主题: 主题是订阅的首要关系，不管是生产者还是消费者都是和主题进行关联订阅，而主题内是由队列组成，队列拥有读、写等权限控制，主题通过队列进行横向扩展，来提要主题的性能，主题是存储消息的实际。</p>
<p>消息: 消息是队列内信息流通的最小粒子，消息本身拥有一定的特性，如延迟消息等。</p>
<p>生产者: 生产者通过向指定的主题发送消息完成生产任务，更多理解暂时没有</p>
<p>消费者: 消费者必定需要提起续费这分组，因为消费者与主题之间的订阅关系是由消费者分组完成的，换句话说，消费者与主题没有直接关系，与主题有直接关系的是消费者组，消费者组通过订阅关系与主题构建关联，而消费者属于消费者组，那么在消费者组得到消息之后，通过进一步的消息订阅关系分发给组下面的消费者，需要注意的是，在同一个消费者分组下的消费者，其订阅关系必须保持一致性，如果多个消费者分组订阅同一个主题，那么这个主题的消息会分发给所有的消费者分组。</p>
<p><img src="https://rocketmq.apache.org/zh/assets/images/archiforproducer-ebb8ff832f6e857cbebc2c17c2044a3b.png" alt="alt"></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E5%85%B3%E7%B3%BB%E6%A2%B3%E7%90%86/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Zookeeper%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2/">
        <h2 class="post-title">Zookeeper单机部署</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                中间件
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <hr>
<h2 id="title-Zookeeper单机部署date-2022-10-10-13-59-49-654updated-2022-10-13-14-44-16-087url-x2F-archives-x2F-zookeeper-dan-ji-bu-shucategories-Zookeepertags-Zookeeper"><a href="#title-Zookeeper单机部署date-2022-10-10-13-59-49-654updated-2022-10-13-14-44-16-087url-x2F-archives-x2F-zookeeper-dan-ji-bu-shucategories-Zookeepertags-Zookeeper" class="headerlink" title="title: Zookeeper单机部署date: 2022-10-10 13:59:49.654updated: 2022-10-13 14:44:16.087url: &#x2F;archives&#x2F;zookeeper-dan-ji-bu-shucategories:- Zookeepertags:- Zookeeper"></a>title: Zookeeper单机部署<br>date: 2022-10-10 13:59:49.654<br>updated: 2022-10-13 14:44:16.087<br>url: &#x2F;archives&#x2F;zookeeper-dan-ji-bu-shu<br>categories:<br>- Zookeeper<br>tags:<br>- Zookeeper</h2><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><blockquote>
<p>CentOS7、openJdk11</p>
</blockquote>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ol>
<li>首先使用<code>wget</code>下载zk的二进制包 <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">    <span class="token function">wget</span> https://dlcdn.apache.org/zookeeper/zookeeper-3.8.0/apache-zookeeper-3.8.0-bin.tar.gz
    ```<span class="token variable"><span class="token variable">`</span>
<span class="token number">2</span>. 解压出到opt目录下
   <span class="token variable">`</span></span>``shell
   <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-zookeeper-3.8.0-bin.tar.gz <span class="token parameter variable">-O</span> /opt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li>配置systemd服务管理<br> 在&#x2F;etc&#x2F;systemd&#x2F;system目录下创建zkServer.service文件<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>zkServer

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token comment">#PIDFile=/var/run/zkServer_2181.pid</span>
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/opt/apache-zookeeper-3.8.0-bin/bin/zkServer.sh start
<span class="token assign-left variable">ExecStartPost</span><span class="token operator">=</span>/bin/sleep <span class="token number">0.1</span>
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/opt/apache-zookeeper-3.8.0-bin/bin/zkServer.sh stop
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html">含义参考</a></li>
<li>使用systemd启用服务即可 <pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 启用</span>
systemctl start zkServer
<span class="token comment"># 停止</span>
systemctl stop zkServer
<span class="token comment"># 重启</span>
systemctl restart zkServer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Zookeeper%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/IO%E4%B8%8ENIO/">
        <h2 class="post-title">IO与NIO</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/Java%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Java基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="IO与NIO"><a href="#IO与NIO" class="headerlink" title="IO与NIO"></a>IO与NIO</h1><h3 id="1、阻塞与非阻塞"><a href="#1、阻塞与非阻塞" class="headerlink" title="1、阻塞与非阻塞"></a>1、阻塞与非阻塞</h3><p>阻塞与非阻塞是描述进程在访问某个资源时，数据是否准备就绪的的一种处理方式。当数据没有准备就绪时：</p>
<ul>
<li>阻塞：线程持续等待资源中数据准备完成，直到返回响应结果。</li>
<li>非阻塞：线程直接返回结果，不会持续等待资源准备数据结束后才响应结果。</li>
</ul>
<h3 id="2、同步与异步"><a href="#2、同步与异步" class="headerlink" title="2、同步与异步"></a>2、同步与异步</h3><ul>
<li>同步与异步是指访问数据的机制，同步一般指主动请求并等待IO操作完成的方式。</li>
<li>异步则指主动请求数据后便可以继续处理其它任务，随后等待IO操作完毕的通知。</li>
</ul>
<p>老王烧开水：<br> 1、普通水壶煮水，站在旁边，主动的看水开了没有？同步的阻塞<br> 2、普通水壶煮水，去干点别的事，每过一段时间去看看水开了没有，水没开就走人。 同步非阻塞<br> 3、响水壶煮水，站在旁边，不会每过一段时间主动看水开了没有。如果水开了，水壶自动通知他。 异步阻塞<br> 4、响水壶煮水，去干点别的事，如果水开了，水壶自动通知他。异步非阻塞</p>
<h3 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h3><h4 id="1、传统BIO模型"><a href="#1、传统BIO模型" class="headerlink" title="1、传统BIO模型"></a>1、传统BIO模型</h4><p>传统BIO是一种同步的阻塞IO，IO在进行读写时，该线程将被阻塞，线程无法进行其它操作。<br> IO流在读取时，会阻塞。直到发生以下情况：1、有数据可以读取。2、数据读取完成。3、发生异常</p>
<h4 id="2、伪异步IO模型"><a href="#2、伪异步IO模型" class="headerlink" title="2、伪异步IO模型"></a>2、伪异步IO模型</h4><p>以传统BIO模型为基础，通过线程池的方式维护所有的IO线程，实现相对高效的线程开销及管理。</p>
<h4 id="3、NIO模型"><a href="#3、NIO模型" class="headerlink" title="3、NIO模型"></a>3、NIO模型</h4><p>NIO（JDK1.4）模型是一种同步非阻塞IO，主要有三大核心部分：Channel(通道)，Buffer(缓冲区), Selector（多路复用器）。传统IO基于字节流和字符流进行操作，而NIO基于Channel和Buffer(缓冲区)进行操作，数据总是从通道读取到缓冲区中，或者从缓冲区写入到通道中。Selector(多路复用器)用于监听多个通道的事件（比如：连接打开，数据到达）。因此，单个线程可以监听多个数据通道。<br> NIO和传统IO（一下简称IO）之间第一个最大的区别是，IO是面向流的，NIO是面向缓冲区的。 Java IO面向流意味着每次从流中读一个或多个字节，直至读取所有字节，它们没有被缓存在任何地方。此外，它不能前后移动流中的数据。如果需要前后移动从流中读取的数据，需要先将它缓存到一个缓冲区。NIO的缓冲导向方法略有不同。数据读取到一个它稍后处理的缓冲区，需要时可在缓冲区中前后移动。这就增加了处理过程中的灵活性。但是，还需要检查是否该缓冲区中包含所有您需要处理的数据。而且，需确保当更多的数据读入缓冲区时，不要覆盖缓冲区里尚未处理的数据。<br> IO的各种流是阻塞的。这意味着，当一个线程调用read() 或 write()时，该线程被阻塞，直到有一些数据被读取，或数据完全写入。该线程在此期间不能再干任何事情了。 NIO的非阻塞模式，使一个线程从某通道发送请求读取数据，但是它仅能得到目前可用的数据，如果目前没有数据可用时，就什么都不会获取。而不是保持线程阻塞，所以直至数据变的可以读取之前，该线程可以继续做其他的事情。 非阻塞写也是如此。一个线程请求写入一些数据到某通道，但不需要等待它完全写入，这个线程同时可以去做别的事情。 线程通常将非阻塞IO的空闲时间用于在其它通道上执行IO操作，所以一个单独的线程现在可以管理多个输入和输出通道（channel）。</p>
<h4 id="NIO优点："><a href="#NIO优点：" class="headerlink" title="NIO优点："></a>NIO优点：</h4><ol>
<li>通过Channel注册到Selector上的状态来实现一种客户端与服务端的通信。</li>
<li>Channel中数据的读取是通过Buffer , 一种非阻塞的读取方式。</li>
<li>Selector 多路复用器  单线程模型，  线程的资源开销相对比较小。</li>
</ol>
<h4 id="Channel-通道"><a href="#Channel-通道" class="headerlink" title="Channel(通道)"></a>Channel(通道)</h4><p>传统IO操作对read()或write()方法的调用，可能会因为没有数据可读&#x2F;可写而阻塞，直到有数据响应。也就是说读写数据的IO调用，可能会无限期的阻塞等待，效率依赖网络传输的速度。最重要的是在调用一个方法前，无法知道是否会被阻塞。</p>
<p>NIO的Channel抽象了一个重要特征就是可以通过配置它的阻塞行为，来实现非阻塞式的通道。</p>
<p>Channel是一个双向通道，与传统IO操作只允许单向的读写不同的是，NIO的Channel允许在一个通道上进行读和写的操作。</p>
<p>FileChannel:文件</p>
<p>SocketChannel:</p>
<p>ServerSocketChannel:</p>
<p>DatagramChannel: UDP</p>
<h4 id="Buffer-缓冲区"><a href="#Buffer-缓冲区" class="headerlink" title="Buffer(缓冲区)"></a>Buffer(缓冲区)</h4><p>Bufer顾名思义，它是一个缓冲区，实际上是一个容器，一个连续数组。Channel提供从文件、网络读取数据的渠道，但是读写的数据都必须经过Buffer。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13449209-300fd48a7251c327.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/654/format/webp" alt="img"></p>
<p>Buffer(缓冲区)</p>
<p>Buffer缓冲区本质上是一块可以写入数据，然后可以从中读取数据的内存。这块内存被包装成NIO Buffer对象，并提供了一组方法，用来方便的访问该模块内存。为了理解Buffer的工作原理，需要熟悉它的三个属性：capacity、position和limit。</p>
<p>position和limit的含义取决于Buffer处在读模式还是写模式。不管Buffer处在什么模式，capacity的含义总是一样的。见下图：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/13449209-d261cbcb9b9ed88f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/506/format/webp" alt="img"></p>
<p>capacity、position和limit</p>
<ul>
<li>capacity：作为一个内存块，Buffer有固定的大小值，也叫作“capacity”，只能往其中写入capacity个byte、long、char等类型。一旦Buffer满了，需要将其清空（通过读数据或者清楚数据）才能继续写数据。</li>
<li>position：当你写数据到Buffer中时，position表示当前的位置。出事的position值为0，当写入一个字节数据到Buffer中后，position会向前移动到下一个可插入数据的Buffer单元。position最大可为capacity-1。当读取数据时，也是从某个特定位置读，讲Buffer从写模式切换到读模式，position会被重置为0。当从Buffer的position处读取一个字节数据后，position向前移动到下一个可读的位置。</li>
<li>limit：在写模式下，Buffer的limit表示你最多能往Buffer里写多少数据。 写模式下，limit等于Buffer的capacity。当切换Buffer到读模式时， limit表示你最多能读到多少数据。因此，当切换Buffer到读模式时，limit会被设置成写模式下的position值。换句话说，你能读到之前写入的所有数据（limit被设置成已写数据的数量，这个值在写模式下就是position）</li>
</ul>
<h4 id="Buffer的分配："><a href="#Buffer的分配：" class="headerlink" title="Buffer的分配："></a>Buffer的分配：</h4><p>对Buffer对象的操作必须首先进行分配，Buffer提供一个allocate(int capacity)方法分配一个指定字节大小的对象。<br> 向Buffer中写数据：写数据到Buffer中有两种方式：<br> 1.从channel写到Buffer</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> bytes <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将channel中的数据读取到buf中</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>2.通过Buffer的put()方法写到Buffer</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">buf<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将数据通过put()方法写入到buf中</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>flip()方法：将Buffer从写模式切换到读模式，调用flip()方法会将position设置为0，并将limit设置为之前的position的值。<br> 从Buffer中读数据：从Buffer中读数据有两种方式：<br> 1.从Buffer读取数据到Channel</li>
</ul>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token keyword">int</span> bytes <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将buf中的数据读取到channel中</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>2.通过Buffer的get()方法读取数据</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp"><span class="token class-name"><span class="token keyword">byte</span></span> bt <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//从buf中读取一个byte</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>rewind()方法：Buffer.rewind()方法将position设置为0，使得可以重读Buffer中的所有数据，limit保持不变。</li>
<li>clear()与compact()方法：一旦读完Buffer中的数据，需要让Buffer准备好再次被写入，可以通过clear()或compact()方法完成。如果调用的是clear()方法，position将被设置为0，limit设置为capacity的值。但是Buffer并未被清空，只是通过这些标记告诉我们可以从哪里开始往Buffer中写入多少数据。如果Buffer中还有一些未读的数据，调用clear()方法将被”遗忘 “。compact()方法将所有未读的数据拷贝到Buffer起始处，然后将position设置到最后一个未读元素的后面，limit属性依然设置为capacity。可以使得Buffer中的未读数据还可以在后续中被使用。</li>
<li>mark()与reset()方法：通过调用Buffer.mark()方法可以标记一个特定的position，之后可以通过调用Buffer.reset()恢复到这个position上。</li>
</ul>
<h4 id="Selector-多路复用器"><a href="#Selector-多路复用器" class="headerlink" title="Selector(多路复用器)"></a>Selector(多路复用器)</h4><p>Selector与Channel是相互配合使用的，将Channel注册在Selector上之后，才可以正确的使用Selector，但此时Channel必须为非阻塞模式。Selector可以监听Channel的四种状态（Connect、Accept、Read、Write），当监听到某一Channel的某个状态时，才允许对Channel进行相应的操作。</p>
<ul>
<li>Connect：某一个客户端连接成功后</li>
<li>Accept：准备好进行连接</li>
<li>Read:可读</li>
<li>Write:可写</li>
</ul>
<p>作者：林亚希<br>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5bb812ca5f8e">https://www.jianshu.com/p/5bb812ca5f8e</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/IO%E4%B8%8ENIO/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jar%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/">
        <h2 class="post-title">Jar后台运行</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/Java%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Java基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="JAR后台运行"><a href="#JAR后台运行" class="headerlink" title="JAR后台运行"></a>JAR后台运行</h1><p>保存后台运行，且把日志信息打印输出到指定的文件中</p>
<p>jar name：jar包的名字</p>
<p>log file：完整的日志文件路径，包括日志文件</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">nohup</span> <span class="token function">java</span> <span class="token parameter variable">-jar</span> <span class="token string">'jar name'</span> <span class="token operator">></span> <span class="token string">'log file'</span> <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jar%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/JavaScript%E8%8E%B7%E5%8F%96%E8%A7%86%E9%A2%91%E6%B5%81%E4%B8%94%E5%9B%9E%E6%98%BE/">
        <h2 class="post-title">JavaScript获取视频流且回显</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/Java%E5%9F%BA%E7%A1%80/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Java基础
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="JavaScript获取视频流且回显"><a href="#JavaScript获取视频流且回显" class="headerlink" title="JavaScript获取视频流且回显"></a>JavaScript获取视频流且回显</h1><pre class="line-numbers language-HTML" data-language="HTML"><code class="language-HTML">&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;style&gt;

		&lt;&#x2F;style&gt;
	&lt;&#x2F;head&gt;
	&lt;body&gt;
		&lt;video id&#x3D;&quot;video&quot; width&#x3D;&quot;640&quot; height&#x3D;&quot;480&quot; autoplay&#x3D;&quot;autoplay&quot;&gt;&lt;&#x2F;video&gt;
		&lt;br&#x2F;&gt;
		&lt;button id&#x3D;&quot;snap&quot;&gt;截取图像&lt;&#x2F;button&gt;&lt;button id&#x3D;&quot;start&quot;&gt;开始录制&lt;&#x2F;button&gt;&lt;button id&#x3D;&quot;stop&quot;&gt;停止录制&lt;&#x2F;button&gt;
		&lt;br&#x2F;&gt;
		&lt;canvas id&#x3D;&quot;canvas&quot; width&#x3D;&quot;640&quot; height&#x3D;&quot;480&quot;&gt;&lt;&#x2F;canvas&gt;
	&lt;&#x2F;body&gt;
	&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
		let videoView &#x3D; document.getElementById(&quot;video&quot;);
		let buttonView &#x3D; document.getElementById(&quot;snap&quot;);
		let startButton &#x3D; document.getElementById(&quot;start&quot;);
		let stopButton &#x3D; document.getElementById(&quot;stop&quot;);
		let canvasView &#x3D; document.getElementById(&quot;canvas&quot;);

		navigator.mediaDevices.getDisplayMedia(&#123;
			video: &#123;
				width: 640,
				height: 480
			&#125;,
			audio: true
		&#125;).then(stream &#x3D;&gt; &#123;
			console.log(&quot;摄像头打开成功！！！&quot;, stream);
			&#x2F;&#x2F;以ID为基准,video控件的ID是什么此处的video就是什么
			video.srcObject &#x3D; stream;

			&#x2F;&#x2F; 创建下载对象
			let mediaRecorder &#x3D; new MediaRecorder(stream, &#123;
				audioBitsPerSecond: 128000, &#x2F;&#x2F; 音频码率
				videoBitsPerSecond: 100000, &#x2F;&#x2F; 视频码率
				mimeType: &#39;video&#x2F;webm;codecs&#x3D;h264&#39; &#x2F;&#x2F; 编码格式
			&#125;);
			startButton.onclick &#x3D; (e &#x3D;&gt; &#123;
				console.log(&quot;触发下载按钮！！！&quot;, e)
				mediaRecorder.start(5000);
			&#125;);
			stopButton.onclick &#x3D; (e &#x3D;&gt; &#123;
				console.log(&quot;触发结束按钮！！！&quot;, e)
				mediaRecorder.stop();
			&#125;);
			mediaRecorder.ondataavailable &#x3D; (e &#x3D;&gt; &#123;
				console.log(&quot;开始下载&quot;)
			    &#x2F;&#x2F; 下载视频
			    var blob &#x3D; new Blob([e.data], &#123; &#39;type&#39; : &#39;video&#x2F;mp4&#39; &#125;)
			    let a &#x3D; document.createElement(&#39;a&#39;)
			    a.href &#x3D; URL.createObjectURL(blob)
			    a.download &#x3D; &#96;test.mp4&#96;
			    a.click()
			&#125;);

			&#x2F;&#x2F;监听流录入失败
			video.onerror &#x3D; (err &#x3D;&gt; &#123;
				console.log(&quot;加载错误！！！&quot;, err);
			&#125;);
			&#x2F;&#x2F;监听流录入成功
			video.onloadeddata &#x3D; (e &#x3D;&gt; &#123;
				console.log(&quot;加载成功！！！&quot;, e);
			&#125;);
		&#125;).catch(stream &#x3D;&gt; &#123;
			console.log(&quot;摄像头打开失败！！！&quot;, stream);
		&#125;);
		&#x2F;&#x2F;给button按钮设置一个点击事件监听
		buttonView.onclick &#x3D; function() &#123;
			&#x2F;&#x2F;获取画布的2d上下文，然后把视频内的一帧绘制到画布上
			canvasView.getContext(&quot;2d&quot;).drawImage(videoView, 0, 0, 640, 480)
		&#125;
	&lt;&#x2F;script&gt;
&lt;&#x2F;html&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/Java%E5%9F%BA%E7%A1%80/JavaScript%E8%8E%B7%E5%8F%96%E8%A7%86%E9%A2%91%E6%B5%81%E4%B8%94%E5%9B%9E%E6%98%BE/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    <div class="prev">
        
    </div>
    <div class="page-index">
        
        <span class="current">1</span>
        
        <span>
            <a class="page-num" href="/page/2/">2</a>
            
            <a class="page-num" href="/page/3">3</a>
            
            
            <span class="page-omit">...</span>
            <a class="page-num" href="/page/9">9</a>
            
        </span>
        
    </div>
    <div class="next">
        
        <a class="page-num" href="/page/2/">
            <i class="fa-solid fa-caret-right fa-fw"></i>
        </a>
        
    </div>
</div>

    </div>
    
    <div id="home-card">
        <div id="card-div">
    <div class="card-style">
        <div class="avatar">
            <img src="https://static-argvchs.netlify.app/images/avatar.jpg" alt="avatar" />
        </div>
        <div class="name">ajiehome</div>
        <div class="description">
            <p>Here’s an argvchs…</p>

        </div>
        
        <div class="icon-links">
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://github.com/argvchs">
                    <i
                        class="fa-brands fa-github fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&uin=3364555156&site=qq&menu=yes">
                    <i
                        class="fa-brands fa-qq fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://twitter.com/argvchs">
                    <i
                        class="fa-brands fa-twitter fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a href="mailto:argvchs@outlook.com">
                    <i
                        class="fa-solid fa-envelope fa-fw"
                    ></i>
                </a>
            </span>
            
        </div>
        
        
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://blog.yuzi.dev">Yuzi</a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://lynxcatthethird.github.io">LynxCatTheThird</a>
            </div>
            
        </div>
        
    </div>
</div>

    </div>
    
</div>

                    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 阿杰之家
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;ajiehome
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

                </div>
            </transition>
            
            <transition name="fade">
                <div id="preview" ref="preview" v-show="previewShow">
                    <img id="preview-content" ref="previewContent" />
                </div>
            </transition>
            
        </div>
        <script src="/js/main.js"></script>
        <script>
            console.info("Welcome to Argvchs' blog!");
            if (!window.hasOwnProperty("ontouchstart")) {
                let html = '<canvas id="fireworks" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"></canvas><script src="https://static-argvchs.netlify.app/js/fireworks.min.js"><\/script>';
                document.body.append(document.createRange().createContextualFragment(html));
            }
        </script>
        
    </body>
</html>
