<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>阿杰之家</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="山有扶苏，隰有荷华">
<meta property="og:type" content="website">
<meta property="og:title" content="阿杰之家">
<meta property="og:url" content="http://ajiehome.online/page/4/index.html">
<meta property="og:site_name" content="阿杰之家">
<meta property="og:description" content="山有扶苏，隰有荷华">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ajiehome">
<meta property="article:tag" content="ajiehome">
<meta property="article:tag" content="阿杰之家">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/hexo-web/atom.xml" title="阿杰之家" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/hexo-web/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/hexo-web/css/style.css">

  
    
<link rel="stylesheet" href="/hexo-web/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/hexo-web/" id="logo">阿杰之家</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/hexo-web/" id="subtitle">山有扶苏，隰有荷华</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/hexo-web/">Home</a>
        
          <a class="main-nav-link" href="/hexo-web/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/hexo-web/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://ajiehome.online"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-开发工具/Git设置网络代理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/">Git设置网络代理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="设置http、https代理"><a href="#设置http、https代理" class="headerlink" title="设置http、https代理"></a>设置http、https代理</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">config --global http.proxy http://127.0.0.1:10809</span></span><br><span class="line"><span class="attr">git</span> <span class="string">config --global https.proxy socks5://127.0.0.1:10808</span></span><br></pre></td></tr></table></figure>

<h2 id="查看http、https代理配置情况"><a href="#查看http、https代理配置情况" class="headerlink" title="查看http、https代理配置情况"></a>查看http、https代理配置情况</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">config --global --get http.proxy</span></span><br><span class="line"><span class="attr">git</span> <span class="string">config --global --get https.proxy</span></span><br></pre></td></tr></table></figure>

<h2 id="取消http、https代理配置"><a href="#取消http、https代理配置" class="headerlink" title="取消http、https代理配置"></a>取消http、https代理配置</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">git</span> <span class="string">config --global --unset http.proxy</span></span><br><span class="line"><span class="attr">git</span> <span class="string">config --global --unset https.proxy</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/Git%E8%AE%BE%E7%BD%AE%E7%BD%91%E7%BB%9C%E4%BB%A3%E7%90%86/" data-id="clilg59gq0027bpowcv33dkch" data-title="Git设置网络代理" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开发工具/IntelliJ_IDEA_快捷键" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IntelliJ_IDEA_%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IntelliJ_IDEA_%E5%BF%AB%E6%8D%B7%E9%94%AE/">IntelliJ_IDEA_快捷键</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="IntelliJ-IDEA-快捷键"><a href="#IntelliJ-IDEA-快捷键" class="headerlink" title="IntelliJ IDEA 快捷键"></a>IntelliJ IDEA 快捷键</h1><h3 id="1-Editing-编辑"><a href="#1-Editing-编辑" class="headerlink" title="1. Editing(编辑)"></a><strong>1. Editing(编辑)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Ctrl +Space</strong></td>
<td align="left"><strong>基本代码补全，输入字母按后列出匹配的词组</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+Space</strong></td>
<td align="left"><strong>智能代码补全，列出与预期类型一致的方法或变量</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Space</strong></td>
<td align="left"><strong>补全类名</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+Enter</strong></td>
<td align="left"><strong>补全语句</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+P</strong></td>
<td align="left"><strong>显示方法参数</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Q</strong></td>
<td align="left"><strong>显示注释文档</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F1</strong></td>
<td align="left"><strong>显示外部文档</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+mouse over code</strong></td>
<td align="left"><strong>显示描述信息</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F1</strong></td>
<td align="left"><strong>显示提示、警告、错误等信息</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Insert</strong></td>
<td align="left"><strong>生成代码，生成 Getter、Setter、构造器等</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+O</strong></td>
<td align="left"><strong>重写父类方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+I</strong></td>
<td align="left"><strong>实现接口方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+T</strong></td>
<td align="left"><strong>使用(if..else, try..catch, for, synchronized 等)包围选中语句</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+&#x2F;</strong></td>
<td align="left"><strong>使用“&#x2F;&#x2F;”注释或取消注释</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+&#x2F;</strong></td>
<td align="left"><strong>使用“&#x2F;** **&#x2F;”注释或取消注释</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+W</strong></td>
<td align="left"><strong>选择代码块，连续按会增加选择外层的代码块</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+W</strong></td>
<td align="left"><strong>与“Ctrl+W”相反，减少选择代码块</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Q</strong></td>
<td align="left"><strong>显示类描述信息</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Enter</strong></td>
<td align="left"><strong>显示快速修复列表</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+L</strong></td>
<td align="left"><strong>格式化代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+O</strong></td>
<td align="left"><strong>优化 Imports</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+I</strong></td>
<td align="left"><strong>自动优化代码缩进</strong></td>
</tr>
<tr>
<td align="left"><strong>Tab&#x2F;Shift+Tab</strong></td>
<td align="left"><strong>缩进代码&#x2F;取消缩进代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+X or Shift+Delete</strong></td>
<td align="left"><strong>剪切代码，未选择代码时剪切当前行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+C or Ctrl+Insert</strong></td>
<td align="left"><strong>复制代码，未选择代码时复制当前行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+V or Shift+Insert</strong></td>
<td align="left"><strong>粘贴代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+V</strong></td>
<td align="left"><strong>粘贴最近复制的内容</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+D</strong></td>
<td align="left"><strong>重复代码，未选择代码时重复当前行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Y</strong></td>
<td align="left"><strong>删除行，未选择时删除当前行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+J</strong></td>
<td align="left"><strong>合并多行为一行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Enter</strong></td>
<td align="left"><strong>分割一行为多行</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+Enter</strong></td>
<td align="left"><strong>使光标所在位置的下一行为新行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+U</strong></td>
<td align="left"><strong>对选中内容进行大小写切换</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+]&#x2F;[</strong></td>
<td align="left"><strong>选中到代码块的开始&#x2F;结束</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Delete</strong></td>
<td align="left"><strong>删除从光标所在位置到单词结束位置的字符</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Backspace</strong></td>
<td align="left"><strong>删除从单词起始位置到光标所在位置的字符</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+NumPad+&#x2F;-</strong></td>
<td align="left"><strong>展开或收起代码块</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+NumPad+</strong></td>
<td align="left"><strong>展开所有代码块</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+NumPad-</strong></td>
<td align="left"><strong>收起所有代码块</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F4</strong></td>
<td align="left"><strong>关闭当前编辑页</strong></td>
</tr>
<tr>
<td align="left"><strong>CTRL+ALT+B</strong></td>
<td align="left"><strong>查找接口的实现类</strong></td>
</tr>
<tr>
<td align="left"><strong>CTRL+ALT+SHIFT+C</strong></td>
<td align="left"><strong>复制类的全类名</strong></td>
</tr>
</tbody></table>
<h3 id="2-Search-x2F-Replace-查找-x2F-替换"><a href="#2-Search-x2F-Replace-查找-x2F-替换" class="headerlink" title="2. Search&#x2F;Replace(查找&#x2F;替换)"></a><strong>2. Search&#x2F;Replace(查找&#x2F;替换)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Double Shift</strong></td>
<td align="left"><strong>Search everywhere</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F</strong></td>
<td align="left"><strong>查找</strong></td>
</tr>
<tr>
<td align="left"><strong>F3</strong></td>
<td align="left"><strong>查找下一个</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F3</strong></td>
<td align="left"><strong>查找上一个</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+R</strong></td>
<td align="left"><strong>替换</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F</strong></td>
<td align="left"><strong>目录内查找</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+R</strong></td>
<td align="left"><strong>目录内替换</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+S</strong></td>
<td align="left"><strong>语法模板搜索</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+M</strong></td>
<td align="left"><strong>语法模板替换</strong></td>
</tr>
</tbody></table>
<h3 id="3-Usage-Search-使用搜索"><a href="#3-Usage-Search-使用搜索" class="headerlink" title="3. Usage Search(使用搜索)"></a><strong>3. Usage Search(使用搜索)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Alt+F7</strong></td>
<td align="left"><strong>查找被使用处</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F7</strong></td>
<td align="left"><strong>查找当前文件中的使用处</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F7</strong></td>
<td align="left"><strong>高亮当前文件中的使用处</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+F7</strong></td>
<td align="left"><strong>列出使用者</strong></td>
</tr>
</tbody></table>
<h3 id="4-Compile-and-Run-编译-x2F-运行"><a href="#4-Compile-and-Run-编译-x2F-运行" class="headerlink" title="4. Compile and Run(编译&#x2F;运行)"></a><strong>4. Compile and Run(编译&#x2F;运行)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Ctrl+F9</strong></td>
<td align="left"><strong>Make 模块、项目</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F9</strong></td>
<td align="left"><strong>编译选中的文件、模块、项目</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Shift+F10</strong></td>
<td align="left"><strong>选择配置后运行代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Shift+F9</strong></td>
<td align="left"><strong>选择配置后调试代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F10</strong></td>
<td align="left"><strong>运行代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F9</strong></td>
<td align="left"><strong>调试代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F2</strong></td>
<td align="left"><strong>停止调试</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F10</strong></td>
<td align="left"><strong>运行代码</strong></td>
</tr>
</tbody></table>
<h3 id="5-Debugging-调试"><a href="#5-Debugging-调试" class="headerlink" title="5. Debugging(调试)"></a><strong>5. Debugging(调试)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>F8</strong></td>
<td align="left"><strong>单步调试，不进入函数内部</strong></td>
</tr>
<tr>
<td align="left"><strong>F7</strong></td>
<td align="left"><strong>单步调试，进入函数内部</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F7&#x2F;Alt+Shift+F7</strong></td>
<td align="left"><strong>选择要进入的函数&#x2F;强制进入函数</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F8</strong></td>
<td align="left"><strong>跳出函数</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+F9</strong></td>
<td align="left"><strong>运行到断点</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+F8</strong></td>
<td align="left"><strong>执行表达式查看结果</strong></td>
</tr>
<tr>
<td align="left"><strong>F9</strong></td>
<td align="left"><strong>继续执行，进入下一个断点或执行完程序</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F8</strong></td>
<td align="left"><strong>设置&#x2F;取消当前行断点</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F8</strong></td>
<td align="left"><strong>查看断点</strong></td>
</tr>
</tbody></table>
<h3 id="6-Navigation-导航"><a href="#6-Navigation-导航" class="headerlink" title="6. Navigation(导航)"></a><strong>6. Navigation(导航)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Double Shift</strong></td>
<td align="left"><strong>查找所有</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+N</strong></td>
<td align="left"><strong>查找类</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+N</strong></td>
<td align="left"><strong>查找文件</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Shift+N</strong></td>
<td align="left"><strong>Go to symbol</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Right&#x2F;Left</strong></td>
<td align="left"><strong>左右切换 Tab</strong></td>
</tr>
<tr>
<td align="left"><strong>F12</strong></td>
<td align="left"><strong>回到上一个打开的窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Esc</strong></td>
<td align="left"><strong>焦点回到编辑器</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+Esc</strong></td>
<td align="left"><strong>隐藏打开的视图</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F4</strong></td>
<td align="left"><strong>关闭当前 Tab</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+G</strong></td>
<td align="left"><strong>跳到指定行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+E</strong></td>
<td align="left"><strong>显示最近打开的文件</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Left</strong></td>
<td align="left"><strong>跳到光标的上一个位置</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Right</strong></td>
<td align="left"><strong>跳到光标的下一个位置</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+Backspace</strong></td>
<td align="left"><strong>跳到上一个编辑处</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+F1</strong></td>
<td align="left"><strong>选择当前文件显示在不同的视图中</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+B or Ctrl+Click</strong></td>
<td align="left"><strong>跳到类声明处</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+B</strong></td>
<td align="left"><strong>跳到实现类&#x2F;方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+I</strong></td>
<td align="left"><strong>显示类&#x2F;变量&#x2F;方法定义</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+B</strong></td>
<td align="left"><strong>跳到类型定义处</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+U</strong></td>
<td align="left"><strong>跳到父类&#x2F;方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Up</strong></td>
<td align="left"><strong>光标移动到上一个方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Down</strong></td>
<td align="left"><strong>光标移动到下一个方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+]</strong></td>
<td align="left"><strong>光标移动到代码块的起始位置</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+]</strong></td>
<td align="left"><strong>光标移动到代码块的结束位置</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F12</strong></td>
<td align="left"><strong>显示文件结构</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+H</strong></td>
<td align="left"><strong>显示类层级</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+H</strong></td>
<td align="left"><strong>显示方法层级</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+H</strong></td>
<td align="left"><strong>显示类&#x2F;方法调用层级</strong></td>
</tr>
<tr>
<td align="left"><strong>F2</strong></td>
<td align="left"><strong>光标移动到下一个错误</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F2</strong></td>
<td align="left"><strong>标移动到上一个错误</strong></td>
</tr>
<tr>
<td align="left"><strong>F4</strong></td>
<td align="left"><strong>编辑源码，光标移到编辑器内</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Enter</strong></td>
<td align="left"><strong>查看源码，光标没移到编辑器内</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Home</strong></td>
<td align="left"><strong>显示导航面包屑</strong></td>
</tr>
<tr>
<td align="left"><strong>F11</strong></td>
<td align="left"><strong>当前行设置书签</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F11</strong></td>
<td align="left"><strong>显示所有书签</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F11</strong></td>
<td align="left"><strong>设置书签号[0-9]</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+[0-9]</strong></td>
<td align="left"><strong>跳到书签号[0-9]所在位置</strong></td>
</tr>
</tbody></table>
<h3 id="7-Refactoring-重构"><a href="#7-Refactoring-重构" class="headerlink" title="7. Refactoring(重构)"></a><strong>7. Refactoring(重构)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>F5</strong></td>
<td align="left"><strong>复制类</strong></td>
</tr>
<tr>
<td align="left"><strong>F6</strong></td>
<td align="left"><strong>移动类</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Delete</strong></td>
<td align="left"><strong>安全删除，删除前会提示调用处</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+F6</strong></td>
<td align="left"><strong>重命名</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+F6</strong></td>
<td align="left"><strong>重构方法参数、Exception 等</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+N</strong></td>
<td align="left"><strong>合并多行为一行</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+M</strong></td>
<td align="left"><strong>提取为新方法</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+V</strong></td>
<td align="left"><strong>提取为新变量</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+F</strong></td>
<td align="left"><strong>提取为对象新属性</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+C</strong></td>
<td align="left"><strong>提取为新静态常量</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+P</strong></td>
<td align="left"><strong>提取参数</strong></td>
</tr>
</tbody></table>
<h3 id="8-VCS-x2F-Local-History-版本控制-x2F-本地历史"><a href="#8-VCS-x2F-Local-History-版本控制-x2F-本地历史" class="headerlink" title="8. VCS&#x2F;Local History(版本控制&#x2F;本地历史)"></a><strong>8. VCS&#x2F;Local History(版本控制&#x2F;本地历史)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Ctrl+K</strong></td>
<td align="left"><strong>提交改动到 VCS</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+T</strong></td>
<td align="left"><strong>从 VCS 上更新</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Shift+C</strong></td>
<td align="left"><strong>查看最近的改动记录</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+BackQuote(&#96;)</strong></td>
<td align="left"><strong>显示 VCS 操作列表</strong></td>
</tr>
</tbody></table>
<h3 id="9-Live-Templates-动态模板"><a href="#9-Live-Templates-动态模板" class="headerlink" title="9. Live Templates(动态模板)"></a><strong>9. Live Templates(动态模板)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Ctrl+Alt+J</strong></td>
<td align="left"><strong>使用 Live Template 包围选中代码</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+J</strong></td>
<td align="left"><strong>快速插入 Live Template</strong></td>
</tr>
<tr>
<td align="left"><strong>iter</strong></td>
<td align="left"><strong>快速生成 for…in 语句</strong></td>
</tr>
<tr>
<td align="left"><strong>inst</strong></td>
<td align="left"><strong>快速生成”if instanceof ”语句</strong></td>
</tr>
<tr>
<td align="left"><strong>itco</strong></td>
<td align="left"><strong>快速生成 iterator 的 for 循环</strong></td>
</tr>
<tr>
<td align="left"><strong>itit</strong></td>
<td align="left"><strong>快速生成 iterator 的 while 循环</strong></td>
</tr>
<tr>
<td align="left"><strong>itli</strong></td>
<td align="left"><strong>快速生成 list 的 for(i)循环</strong></td>
</tr>
<tr>
<td align="left"><strong>psf</strong></td>
<td align="left"><strong>快速生成“public static final” 语句</strong></td>
</tr>
<tr>
<td align="left"><strong>thr</strong></td>
<td align="left"><strong>快速生成“throw new” 语句</strong></td>
</tr>
</tbody></table>
<h3 id="10-General-代码生成"><a href="#10-General-代码生成" class="headerlink" title="10. General(代码生成)"></a><strong>10. General(代码生成)</strong></h3><table>
<thead>
<tr>
<th align="left"><strong>快捷键</strong></th>
<th align="left"><strong>介绍</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Alt+0</strong></td>
<td align="left"><strong>聚焦到 Messages 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+1</strong></td>
<td align="left"><strong>聚焦到 Project 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+2</strong></td>
<td align="left"><strong>聚焦到 Favorite 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+3</strong></td>
<td align="left"><strong>聚焦到 Find 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+4</strong></td>
<td align="left"><strong>聚焦到 Run 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+5</strong></td>
<td align="left"><strong>聚焦到 Debug 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+6</strong></td>
<td align="left"><strong>聚焦到 TODO 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+7</strong></td>
<td align="left"><strong>聚焦到 Structure 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+8</strong></td>
<td align="left"><strong>聚焦到 Hierarchy 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+9</strong></td>
<td align="left"><strong>聚焦到 Change 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+S</strong></td>
<td align="left"><strong>保存文件</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Y</strong></td>
<td align="left"><strong>与本地文件同步</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+F12</strong></td>
<td align="left"><strong>切换最大化编辑</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Shift+F</strong></td>
<td align="left"><strong>添加到收藏夹</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+Shift+I</strong></td>
<td align="left"><strong>检查当前文件，包括 Javadoc 问题、可能存在的 bug 等</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+BackQuote (&#96;)</strong></td>
<td align="left"><strong>模式切换，包括文本外观、快捷键、编辑器外观、代码样式。</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+S</strong></td>
<td align="left"><strong>打开 settings 窗口</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Alt+Shift+S</strong></td>
<td align="left"><strong>打开项目结构对话框</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Shift+A</strong></td>
<td align="left"><strong>Find Action</strong></td>
</tr>
<tr>
<td align="left"><strong>Ctrl+Tab</strong></td>
<td align="left"><strong>选项卡和工具窗口之间切换</strong></td>
</tr>
<tr>
<td align="left"><strong>Alt+F12</strong></td>
<td align="left"><strong>打开命令终端</strong></td>
</tr>
<tr>
<td align="left"><strong>Shift+Shift</strong></td>
<td align="left"><strong>搜索文件</strong></td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/IntelliJ_IDEA_%E5%BF%AB%E6%8D%B7%E9%94%AE/" data-id="clilg59gr0029bpowh1searc9" data-title="IntelliJ_IDEA_快捷键" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开发工具/StarUML激活" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/StarUML%E6%BF%80%E6%B4%BB/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/StarUML%E6%BF%80%E6%B4%BB/">StarUML激活</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="StarUML激活"><a href="#StarUML激活" class="headerlink" title="StarUML激活"></a>StarUML激活</h1><p>确切的来说并不是激活StarUML，只是去除了StarUML在未激活时的弹窗提示</p>
<p>原理：对StarUML的依赖启动app.asar文件进行反编译拿到源码，把源码中未激活提示部分移除掉即可，并且关闭自动升级，避免文件被覆盖。</p>
<p>1、app.asar 所使用的时asar程序，那么我们需要先安装一个node，通过node下载asar应用<br>2、找到StarUML的安装目录，在安装目录的resource文件夹下有一个app.asar文件<br>3、使用asar反编译 <code>asar extract app.asar app</code>生成源代码，源代码在app文件夹内，注意：如果是在C盘的管理员目录，需要用管理员身份执行CMD。<br>4、修改<code>app\src\engine\license-manager.js</code>文件中checkLicenseValidity方法的代码  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">checkLicenseValidity () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">validate</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setStatus</span>(<span class="variable language_">this</span>, <span class="literal">true</span>)</span><br><span class="line">    &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//setStatus(this,false)  &lt;-- comment this line</span></span><br><span class="line">    <span class="title function_">setStatus</span>(<span class="variable language_">this</span>, <span class="literal">true</span>) <span class="comment">//&lt;-- add this line</span></span><br><span class="line">    <span class="comment">//UnregisteredDialog.showDialog() &lt;-- comment this line</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5、修改<code>app\src\app-context.js</code>文件的appReady方法的代码，禁止自动更新</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// if (this.preferences.get(&#x27;checkUpdate.checkUpdateOnStart&#x27;)) &#123;</span></span><br><span class="line"><span class="comment">//    ipcRenderer.send(&#x27;check-update&#x27;)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>
<p>6、重新打包覆盖原来的app.asar文件 <code>asar pack app app.asar</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/StarUML%E6%BF%80%E6%B4%BB/" data-id="clilg59gs002cbpow5dk45z7w" data-title="StarUML激活" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/Jwt加密生成" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Jwt%E5%8A%A0%E5%AF%86%E7%94%9F%E6%88%90/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Jwt%E5%8A%A0%E5%AF%86%E7%94%9F%E6%88%90/">Jwt加密生成</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JWT初步使用"><a href="#JWT初步使用" class="headerlink" title="JWT初步使用"></a>JWT初步使用</h1><p><strong>POM文件导入</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.auth0<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>java-jwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.10.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>JWT实现类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtUtils</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  获取Token，签名由ID代替，形成动态签名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> autoDuration 超时的时间长度</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jwtBeanBO 用户数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> token</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getToken</span><span class="params">(<span class="type">long</span> autoDuration, JwtBeanBO jwtBeanBO)</span>&#123;</span><br><span class="line">		</span><br><span class="line">        <span class="type">long</span> <span class="variable">outLong</span> <span class="operator">=</span> System.currentTimeMillis() + autoDuration;</span><br><span class="line">        <span class="type">Date</span> <span class="variable">outDate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(outLong);</span><br><span class="line">        <span class="comment">//加密方式HS256</span></span><br><span class="line">        <span class="type">Algorithm</span> <span class="variable">algorithm</span> <span class="operator">=</span> Algorithm.HMAC256(jwtBeanBO.getId().toString());</span><br><span class="line">        HashMap&lt;String, Object&gt; hashMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">5</span>);</span><br><span class="line">        hashMap.put(<span class="string">&quot;id&quot;</span>,jwtBeanBO.getId());</span><br><span class="line">        hashMap.put(<span class="string">&quot;userName&quot;</span>,jwtBeanBO.getUserName());</span><br><span class="line">        hashMap.put(<span class="string">&quot;passWord&quot;</span>,jwtBeanBO.getPassWord());</span><br><span class="line">        hashMap.put(<span class="string">&quot;userPhone&quot;</span>,jwtBeanBO.getUserPhone());</span><br><span class="line">        hashMap.put(<span class="string">&quot;userAddress&quot;</span>,jwtBeanBO.getUserAddress());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JWT.create()</span><br><span class="line">                .withHeader(hashMap)</span><br><span class="line">                .withIssuer(jwtBeanBO.getUserName())</span><br><span class="line">                .withExpiresAt(outDate)</span><br><span class="line">                .sign(algorithm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>具体操作见:<a target="_blank" rel="noopener" href="https://github.com/auth0/java-jwt">Jwt-Github</a></strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Jwt%E5%8A%A0%E5%AF%86%E7%94%9F%E6%88%90/" data-id="clilg59gt002ebpow87ysewva" data-title="Jwt加密生成" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/Seata1.4.0安装" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata1.4.0%E5%AE%89%E8%A3%85/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata1.4.0%E5%AE%89%E8%A3%85/">Seata1.4.0安装</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="seata-install-1-4-0"><a href="#seata-install-1-4-0" class="headerlink" title="seata-install-1.4.0"></a>seata-install-1.4.0</h1><p>基于seata 1.4.2 实现，涉及到的外部文件有：</p>
<ul>
<li>server 端的 sql 文件</li>
<li>client 端的 sql 文件</li>
<li>nacos-config.sh 执行脚本</li>
<li>config.txt 执行配置文件<br>这些文件修改成了，conf下的 REDEME.md &#x2F; REDEME-zh.md 文件内描述内容，给了所有文件的下载链接，直接查阅该文件即可</li>
</ul>
<hr>
<p><strong>开始配置</strong><br><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/configurations.html">官网参数详情</a><br><a target="_blank" rel="noopener" href="https://github.com/seata/seata/blob/develop/script">Github上Seata的外部文件地址</a></p>
<p>server 端</p>
<ol>
<li><p>首先在 Github 下载所需版本的 Seata-Server 二进制包，并且在服务器解压</p>
</li>
<li><p>下载数据库文件，这里我们选择MySQL，并且在MySQL数据库中创建一个数据库，并且执行下载下来的数据库文件</p>
</li>
<li><p>修改conf目录下的register.conf文件，首先必要修改的是register部分，register部分为seata-server服务启动之后的注册模式（file 、nacos 、eureka、redis、zk、consul、etcd3、sofa），这里我们选择的是nacos，配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">registry &#123;</span><br><span class="line">   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span><br><span class="line">   type = &quot;nacos&quot;</span><br><span class="line"></span><br><span class="line">   nacos &#123;</span><br><span class="line">     application = &quot;seata-server&quot;</span><br><span class="line">     serverAddr = &quot;192.168.246.105:8848&quot;</span><br><span class="line">     group = &quot;SEATA_GROUP&quot;</span><br><span class="line">     namespace = &quot;8b191ab1-8b24-4ea1-be79-5f1668e9046c&quot;</span><br><span class="line">     cluster = &quot;default&quot;</span><br><span class="line">     username = &quot;nacos&quot;</span><br><span class="line">     password = &quot;nacos&quot;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>选贼seata-server服务端的配置文件模式（file、nacos 、apollo、zk、consul、etcd3），如果是选择file就需要同目录下的file.conf文件，作为配置文件，这里我们选择nacos，配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">config &#123;</span><br><span class="line">   # file、nacos 、apollo、zk、consul、etcd3</span><br><span class="line">   type = &quot;nacos&quot;</span><br><span class="line"></span><br><span class="line">   nacos &#123;</span><br><span class="line">     serverAddr = &quot;192.168.246.105:8848&quot;</span><br><span class="line">     namespace = &quot;8b191ab1-8b24-4ea1-be79-5f1668e9046c&quot;</span><br><span class="line">     group = &quot;SEATA_GROUP&quot;</span><br><span class="line">     username = &quot;nacos&quot;</span><br><span class="line">     password = &quot;nacos&quot;</span><br><span class="line">     dataId = &quot;seataServer.properties&quot;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>基于第四步选择的config模式，需要在指定的namespance创建dataId所指定的配置文件，配置文件的内容则是config.txt的内容，修改成需要的数据就好了，下面是我修改的部分，配置如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改事务分组，glcxw_tx_group 是分组，default集群名称</span></span><br><span class="line"><span class="attr">service.vgroupMapping.glcxw_tx_group</span>=<span class="string">default</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 选择配置模式</span></span><br><span class="line"><span class="attr">store.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="attr">store.lock.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="attr">store.session.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># db的配置</span></span><br><span class="line"><span class="attr">store.db.datasource</span>=<span class="string">druid</span></span><br><span class="line"><span class="attr">store.db.dbType</span>=<span class="string">mysql</span></span><br><span class="line"><span class="attr">store.db.driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">store.db.url</span>=<span class="string">jdbc:mysql://192.168.246.107:3306/seata?useUnicode=true&amp;rewriteBatchedStatements=true</span></span><br><span class="line"><span class="attr">store.db.user</span>=<span class="string">glcxw</span></span><br><span class="line"><span class="attr">store.db.password</span>=<span class="string">glcxw_yyds</span></span><br></pre></td></tr></table></figure></li>
<li><p>还需要下载nacos-config.sh脚本文件，然后将修改好的config.txt放在脚本的父目录，例如脚本在conf下，config.txt在seata根目录，执行下面的命令，把每一项添加到nacos，为后面client使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh nacos_config.sh -t 8b191ab1-8b24-4ea1-be79-5f1668e9046c -h 192.168.246.105</span><br></pre></td></tr></table></figure></li>
<li><p>在seata-server的bin目录下执行如下命令，把seata-server注册到nacos中，并且指定访问地址和打开的端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh seata-server.sh -h 192.168.246.110 -p 8091</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务端到此配置完成</p>
</li>
</ol>
<p>client 端</p>
<p><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/configuration/nacos.html">Nacos 配置中心</a></p>
<p><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/registry/index.html">Nacos 注册中心</a></p>
<p>首先按照官方的参照文档需要依赖如下文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>最新版<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.nacos<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nacos-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.0及以上版本<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们用的是springcloud组合seata，因为<code>seata-spring-boot-starter</code>默认带的是1.0.0的seata所以我排除默认的，导入了新的seata 1.4.2</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>创建本地数据库中的<code>undo_log</code>表，在REDEME-zh.md中有提及</p>
</li>
<li><p>配置yaml文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">seata:</span></span><br><span class="line"> <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"> <span class="attr">enable-auto-data-source-proxy:</span> <span class="literal">true</span></span><br><span class="line"> <span class="attr">tx-service-group:</span> <span class="string">glcxw_tx_group</span></span><br><span class="line"> <span class="attr">service:</span></span><br><span class="line">   <span class="attr">vgroup-mapping:</span></span><br><span class="line">     <span class="attr">glcxw_tx_group:</span> <span class="string">default</span></span><br><span class="line">   <span class="attr">disable-global-transaction:</span> <span class="literal">false</span></span><br><span class="line"> <span class="attr">registry:</span></span><br><span class="line">   <span class="attr">type:</span> <span class="string">nacos</span></span><br><span class="line">   <span class="attr">nacos:</span></span><br><span class="line">     <span class="attr">application:</span> <span class="string">seata-server</span></span><br><span class="line">     <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.246</span><span class="number">.105</span><span class="string">:8848</span></span><br><span class="line">     <span class="attr">namespace:</span> <span class="string">8b191ab1-8b24-4ea1-be79-5f1668e9046c</span></span><br><span class="line">     <span class="attr">group:</span> <span class="string">SEATA_GROUP</span></span><br><span class="line">     <span class="attr">username:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">password:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">cluster:</span> <span class="string">default</span></span><br><span class="line"> <span class="attr">config:</span></span><br><span class="line">   <span class="attr">type:</span> <span class="string">nacos</span></span><br><span class="line">   <span class="attr">nacos:</span></span><br><span class="line">     <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.246</span><span class="number">.105</span><span class="string">:8848</span></span><br><span class="line">     <span class="attr">namespace:</span> <span class="string">8b191ab1-8b24-4ea1-be79-5f1668e9046c</span></span><br><span class="line">     <span class="attr">group:</span> <span class="string">SEATA_GROUP</span></span><br><span class="line">     <span class="attr">username:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">password:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">data-id:</span> <span class="string">seataServer.properties</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在业务中使用全局事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GlobalTransactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CommonResult&lt;String&gt; <span class="title function_">create</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">SeataOrder</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SeataOrder</span>(<span class="number">1L</span>, <span class="number">1L</span>, <span class="number">1L</span>, <span class="number">1</span>, <span class="number">1F</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> baseMapper.insert(entity);</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;故意抛出&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CommonResult</span>&lt;String&gt;(<span class="number">200</span>, <span class="string">&quot;SUCCESS&quot;</span>, <span class="string">&quot;插入成功&quot;</span> + entity.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>如果feign调用的服务使用了全局异常处理，那么处理好的异常会让调用端认为异常已经处理好了，业务为正常不需要回滚全局事务，所以我们需要自定义feign的decoder，在全局异常处理完后对返回的数据进行判断，如果业务失败就抛出一个异常，让全局事务检测到，feign的降级也是如此，decoder代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultStatusDecoder</span> <span class="keyword">implements</span> <span class="title class_">Decoder</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Decoder decoder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ResultStatusDecoder</span><span class="params">(Decoder decoder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.decoder = decoder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">decode</span><span class="params">(Response response, Type type)</span> <span class="keyword">throws</span> IOException, DecodeException, FeignException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultStr</span> <span class="operator">=</span> response.body().toString();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> JSONObject.parseObject(resultStr).getInteger(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (code != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;seatA feign rollback&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> decoder.decode(response.toBuilder().body(resultStr, StandardCharsets.UTF_8).build(), type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata1.4.0%E5%AE%89%E8%A3%85/" data-id="clilg59gu002hbpowee4fg8mx" data-title="Seata1.4.0安装" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/Seata分布式事务框架" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%A1%86%E6%9E%B6/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%A1%86%E6%9E%B6/">Seata分布式事务框架</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="title-分布式事务框架Seatadate-2022-03-29-09-30-44-544updated-2022-10-13-15-11-45-326url-x2F-archives-x2F-fen-bu-shi-shi-wu-kuang-jia-seatacategories-Seatatags-Seata"><a href="#title-分布式事务框架Seatadate-2022-03-29-09-30-44-544updated-2022-10-13-15-11-45-326url-x2F-archives-x2F-fen-bu-shi-shi-wu-kuang-jia-seatacategories-Seatatags-Seata" class="headerlink" title="title: 分布式事务框架Seatadate: 2022-03-29 09:30:44.544updated: 2022-10-13 15:11:45.326url: &#x2F;archives&#x2F;fen-bu-shi-shi-wu-kuang-jia-seatacategories:- Seatatags:- Seata"></a>title: 分布式事务框架Seata<br>date: 2022-03-29 09:30:44.544<br>updated: 2022-10-13 15:11:45.326<br>url: &#x2F;archives&#x2F;fen-bu-shi-shi-wu-kuang-jia-seata<br>categories:<br>- Seata<br>tags:<br>- Seata</h2><p>基于seata 1.4.2 实现，涉及到的外部文件有：</p>
<ul>
<li>server 端的 sql 文件</li>
<li>client 端的 sql 文件</li>
<li>nacos-config.sh 执行脚本</li>
<li>config.txt 执行配置文件<br>这些文件修改成了，conf下的 REDEME.md &#x2F; REDEME-zh.md 文件内描述内容，给了所有文件的下载链接，直接查阅该文件即可</li>
</ul>
<hr>
<p><strong>开始配置</strong><br><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/configurations.html">官网参数详情</a><br><a target="_blank" rel="noopener" href="https://github.com/seata/seata/blob/develop/script">Github上Seata的外部文件地址</a></p>
<p>server 端</p>
<ol>
<li><p>首先在 Github 下载所需版本的 Seata-Server 二进制包，并且在服务器解压</p>
</li>
<li><p>下载数据库文件，这里我们选择MySQL，并且在MySQL数据库中创建一个数据库，并且执行下载下来的数据库文件</p>
</li>
<li><p>修改conf目录下的register.conf文件，首先必要修改的是register部分，register部分为seata-server服务启动之后的注册模式（file 、nacos 、eureka、redis、zk、consul、etcd3、sofa），这里我们选择的是nacos，配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">registry &#123;</span><br><span class="line">   # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span><br><span class="line">   type = &quot;nacos&quot;</span><br><span class="line"></span><br><span class="line">   nacos &#123;</span><br><span class="line">     application = &quot;seata-server&quot;</span><br><span class="line">     serverAddr = &quot;192.168.246.105:8848&quot;</span><br><span class="line">     group = &quot;SEATA_GROUP&quot;</span><br><span class="line">     namespace = &quot;8b191ab1-8b24-4ea1-be79-5f1668e9046c&quot;</span><br><span class="line">     cluster = &quot;default&quot;</span><br><span class="line">     username = &quot;nacos&quot;</span><br><span class="line">     password = &quot;nacos&quot;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>选贼seata-server服务端的配置文件模式（file、nacos 、apollo、zk、consul、etcd3），如果是选择file就需要同目录下的file.conf文件，作为配置文件，这里我们选择nacos，配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">config &#123;</span><br><span class="line">   # file、nacos 、apollo、zk、consul、etcd3</span><br><span class="line">   type = &quot;nacos&quot;</span><br><span class="line"></span><br><span class="line">   nacos &#123;</span><br><span class="line">     serverAddr = &quot;192.168.246.105:8848&quot;</span><br><span class="line">     namespace = &quot;8b191ab1-8b24-4ea1-be79-5f1668e9046c&quot;</span><br><span class="line">     group = &quot;SEATA_GROUP&quot;</span><br><span class="line">     username = &quot;nacos&quot;</span><br><span class="line">     password = &quot;nacos&quot;</span><br><span class="line">     dataId = &quot;seataServer.properties&quot;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>基于第四步选择的config模式，需要在指定的namespance创建dataId所指定的配置文件，配置文件的内容则是config.txt的内容，修改成需要的数据就好了，下面是我修改的部分，配置如下：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改事务分组，glcxw_tx_group 是分组，default集群名称</span></span><br><span class="line"><span class="attr">service.vgroupMapping.glcxw_tx_group</span>=<span class="string">default</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 选择配置模式</span></span><br><span class="line"><span class="attr">store.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="attr">store.lock.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="attr">store.session.mode</span>=<span class="string">db</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># db的配置</span></span><br><span class="line"><span class="attr">store.db.datasource</span>=<span class="string">druid</span></span><br><span class="line"><span class="attr">store.db.dbType</span>=<span class="string">mysql</span></span><br><span class="line"><span class="attr">store.db.driverClassName</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">store.db.url</span>=<span class="string">jdbc:mysql://192.168.246.107:3306/seata?useUnicode=true&amp;rewriteBatchedStatements=true</span></span><br><span class="line"><span class="attr">store.db.user</span>=<span class="string">glcxw</span></span><br><span class="line"><span class="attr">store.db.password</span>=<span class="string">glcxw_yyds</span></span><br></pre></td></tr></table></figure></li>
<li><p>还需要下载nacos-config.sh脚本文件，然后将修改好的config.txt放在脚本的父目录，例如脚本在conf下，config.txt在seata根目录，执行下面的命令，把每一项添加到nacos，为后面client使用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh nacos_config.sh -t 8b191ab1-8b24-4ea1-be79-5f1668e9046c -h 192.168.246.105</span><br></pre></td></tr></table></figure></li>
<li><p>在seata-server的bin目录下执行如下命令，把seata-server注册到nacos中，并且指定访问地址和打开的端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh seata-server.sh -h 192.168.246.110 -p 8091</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务端到此配置完成</p>
</li>
</ol>
<p>client 端</p>
<p><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/configuration/nacos.html">Nacos 配置中心</a></p>
<p><a target="_blank" rel="noopener" href="https://seata.io/zh-cn/docs/user/registry/index.html">Nacos 注册中心</a></p>
<p>首先按照官方的参照文档需要依赖如下文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>最新版<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.nacos<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nacos-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.0及以上版本<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们用的是springcloud组合seata，因为<code>seata-spring-boot-starter</code>默认带的是1.0.0的seata所以我排除默认的，导入了新的seata 1.4.2</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>创建本地数据库中的<code>undo_log</code>表，在REDEME-zh.md中有提及</p>
</li>
<li><p>配置yaml文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">seata:</span></span><br><span class="line"> <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"> <span class="attr">enable-auto-data-source-proxy:</span> <span class="literal">true</span></span><br><span class="line"> <span class="attr">tx-service-group:</span> <span class="string">glcxw_tx_group</span></span><br><span class="line"> <span class="attr">service:</span></span><br><span class="line">   <span class="attr">vgroup-mapping:</span></span><br><span class="line">     <span class="attr">glcxw_tx_group:</span> <span class="string">default</span></span><br><span class="line">   <span class="attr">disable-global-transaction:</span> <span class="literal">false</span></span><br><span class="line"> <span class="attr">registry:</span></span><br><span class="line">   <span class="attr">type:</span> <span class="string">nacos</span></span><br><span class="line">   <span class="attr">nacos:</span></span><br><span class="line">     <span class="attr">application:</span> <span class="string">seata-server</span></span><br><span class="line">     <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.246</span><span class="number">.105</span><span class="string">:8848</span></span><br><span class="line">     <span class="attr">namespace:</span> <span class="string">8b191ab1-8b24-4ea1-be79-5f1668e9046c</span></span><br><span class="line">     <span class="attr">group:</span> <span class="string">SEATA_GROUP</span></span><br><span class="line">     <span class="attr">username:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">password:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">cluster:</span> <span class="string">default</span></span><br><span class="line"> <span class="attr">config:</span></span><br><span class="line">   <span class="attr">type:</span> <span class="string">nacos</span></span><br><span class="line">   <span class="attr">nacos:</span></span><br><span class="line">     <span class="attr">server-addr:</span> <span class="number">192.168</span><span class="number">.246</span><span class="number">.105</span><span class="string">:8848</span></span><br><span class="line">     <span class="attr">namespace:</span> <span class="string">8b191ab1-8b24-4ea1-be79-5f1668e9046c</span></span><br><span class="line">     <span class="attr">group:</span> <span class="string">SEATA_GROUP</span></span><br><span class="line">     <span class="attr">username:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">password:</span> <span class="string">nacos</span></span><br><span class="line">     <span class="attr">data-id:</span> <span class="string">seataServer.properties</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在业务中使用全局事务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GlobalTransactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> CommonResult&lt;String&gt; <span class="title function_">create</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">SeataOrder</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SeataOrder</span>(<span class="number">1L</span>, <span class="number">1L</span>, <span class="number">1L</span>, <span class="number">1</span>, <span class="number">1F</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="type">int</span> <span class="variable">insert</span> <span class="operator">=</span> baseMapper.insert(entity);</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;故意抛出&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CommonResult</span>&lt;String&gt;(<span class="number">200</span>, <span class="string">&quot;SUCCESS&quot;</span>, <span class="string">&quot;插入成功&quot;</span> + entity.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>如果feign调用的服务使用了全局异常处理，那么处理好的异常会让调用端认为异常已经处理好了，业务为正常不需要回滚全局事务，所以我们需要自定义feign的decoder，在全局异常处理完后对返回的数据进行判断，如果业务失败就抛出一个异常，让全局事务检测到，feign的降级也是如此，decoder代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultStatusDecoder</span> <span class="keyword">implements</span> <span class="title class_">Decoder</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Decoder decoder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ResultStatusDecoder</span><span class="params">(Decoder decoder)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.decoder = decoder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">decode</span><span class="params">(Response response, Type type)</span> <span class="keyword">throws</span> IOException, DecodeException, FeignException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultStr</span> <span class="operator">=</span> response.body().toString();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> JSONObject.parseObject(resultStr).getInteger(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (code != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;seatA feign rollback&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> decoder.decode(response.toBuilder().body(resultStr, StandardCharsets.UTF_8).build(), type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Seata%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%A1%86%E6%9E%B6/" data-id="clilg59gu002jbpowhuzpexfi" data-title="Seata分布式事务框架" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/SpringBoot中MySQL连接超时" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E4%B8%ADMySQL%E8%BF%9E%E6%8E%A5%E8%B6%85%E6%97%B6/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E4%B8%ADMySQL%E8%BF%9E%E6%8E%A5%E8%B6%85%E6%97%B6/">SpringBoot中MySQL连接超时</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="SpringBoot中MySQL链接超时"><a href="#SpringBoot中MySQL链接超时" class="headerlink" title="SpringBoot中MySQL链接超时"></a>SpringBoot中MySQL链接超时</h1><p>springboot项目启动开始可以访问数据库，但是几分钟之后就会报错 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to validate connection com.mysql.cj.jdbc.ConnectionImpl</span><br></pre></td></tr></table></figure>

<p>由于在使用SpringBoot连接数据库的时候，会建立一个和数据库的连接，这个连接保存在数据库连接池中，而现在这个连接已经Time Out已经不可用了，但是你的连接还是保存在连接池中，SpringBoot还是使用这个连接去连接数据库，所以造成警告信息  </p>
<p>那么知道了原因，我们怎么解决这个问题呢，首先要知道我们可以设置连接在连接池中的存活时间，什么是连接的存活时间呢，简而言之就是你这个连接要保存在连接池中多长时间才被清除，如果你连接时间设置是五分钟，那么这个连接在三分钟的时候timeout了还是得再等两分钟才能被清除  </p>
<p>那么问题就很明了，你的连接在三分钟的时候就已经和数据库断开了连接，但是你默认连接的存活时间是五分钟，所以导致你的springboot项目开始能访问数据库，一会之后就不能访问数据库了  </p>
<p>解决方案<br>那么这样，假设说连接在三分钟的时候和数据库断开了连接，我们设置连接的存活时间是两分钟，连接就一直处于可用状态，当两分钟之后你再次访问数据库，就会new一个连接，这个连接在其生命周期内仍然是可用的  </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">spring</span></span><br><span class="line">  <span class="string">datasource</span></span><br><span class="line">    <span class="attr">hikari:</span></span><br><span class="line">      <span class="attr">max-lifetime:</span> <span class="number">60000</span> <span class="comment">#最大存活时间</span></span><br><span class="line">      <span class="attr">idle-timeout:</span> <span class="number">60000</span> <span class="comment">#空闲连接时间</span></span><br><span class="line">      <span class="attr">connection-timeout:</span> <span class="number">50000</span> <span class="comment">#连接超时时间</span></span><br><span class="line">      <span class="attr">maximum-pool-size:</span> <span class="number">60</span> <span class="comment">#连接池最大数</span></span><br><span class="line">      <span class="attr">minimum-idle:</span> <span class="number">10</span> <span class="comment">#连接池最小数</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E4%B8%ADMySQL%E8%BF%9E%E6%8E%A5%E8%B6%85%E6%97%B6/" data-id="clilg59gw002mbpow6szuctbx" data-title="SpringBoot中MySQL连接超时" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/SpringBoot整合Kafka" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Kafka/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Kafka/">SpringBoot整合Kafka</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>引入Spring-Kafka的POM依赖</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p>配置<code>application.properties</code>信息</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.kafka.bootstrap-servers</span>=<span class="string">10.254.0.2:9092</span></span><br><span class="line"><span class="attr">spring.kafka.consumer.group-id</span>=<span class="string">multiple-consumer-group</span></span><br><span class="line"><span class="attr">spring.kafka.consumer.auto-offset-reset</span>=<span class="string">earliest</span></span><br></pre></td></tr></table></figure>

<p>配置Kafka的Topic</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/19 9:49</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    NewTopic <span class="title function_">multipleTopic</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> TopicBuilder.name(<span class="string">&quot;multiple-topic&quot;</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>编写KafkaTemplate使用的Service</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/19 10:01</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KafkaServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">KafkaService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> KafkaTemplate&lt;String, String&gt; kafkaTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CustomListenableFutureCallback futureCallback;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">(String topic, String message)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ListenableFuture&lt;SendResult&lt;String, String&gt;&gt; send = kafkaTemplate.send(topic, message);</span><br><span class="line">            send.addCallback(futureCallback);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>消息发送回调</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/19 14:10</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomListenableFutureCallback</span> <span class="keyword">implements</span> <span class="title class_">ListenableFutureCallback</span>&lt;SendResult&lt;String, String&gt;&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFailure</span><span class="params">(<span class="meta">@Nullable</span> Throwable throwable)</span> &#123;</span><br><span class="line">        log.error(<span class="string">&quot;kafka send message error&quot;</span>, throwable);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccess</span><span class="params">(SendResult&lt;String, String&gt; sendResult)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;kafka send message success [&#123;&#125;]&quot;</span>, sendResult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>配置监听</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/19 9:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@KafkaListener(topics = &quot;multiple-topic&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultipleListening</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@KafkaHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handler</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;kafka listening message [&#123;&#125;]&quot;</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// @KafkaHandler</span></span><br><span class="line">    <span class="keyword">public</span> &lt;K, V&gt; <span class="keyword">void</span> <span class="title function_">handler0</span><span class="params">(ConsumerRecord&lt;K, V&gt; record, Acknowledgment ack, <span class="meta">@Header(KafkaHeaders.RECEIVED_TOPIC)</span> String topic)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;kafka listening message: topic [&#123;&#125;] key [&#123;&#125;] value [&#123;&#125;]&quot;</span>, topic, record.key(), record.value());</span><br><span class="line">        ack.acknowledge();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Kafka/" data-id="clilg59gw002obpowdgqa8mtf" data-title="SpringBoot整合Kafka" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/SpringBoot整合Zookeeper简单运用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Zookeeper%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Zookeeper%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8/">SpringBoot整合Zookeeper简单运用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="title-SpringBoot整合Zookeeper简单运用date-2022-10-11-10-27-30-04updated-2022-10-13-14-43-42-459url-x2F-archives-x2F-spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories-Zookeeper-SpringBoottags-SpringBoot-Zookeeper"><a href="#title-SpringBoot整合Zookeeper简单运用date-2022-10-11-10-27-30-04updated-2022-10-13-14-43-42-459url-x2F-archives-x2F-spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories-Zookeeper-SpringBoottags-SpringBoot-Zookeeper" class="headerlink" title="title: SpringBoot整合Zookeeper简单运用date: 2022-10-11 10:27:30.04updated: 2022-10-13 14:43:42.459url: &#x2F;archives&#x2F;spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories:- Zookeeper- SpringBoottags:- SpringBoot- Zookeeper"></a>title: SpringBoot整合Zookeeper简单运用<br>date: 2022-10-11 10:27:30.04<br>updated: 2022-10-13 14:43:42.459<br>url: &#x2F;archives&#x2F;spring-boot-zheng-he-zookeeper-jian-dan-yun-yong<br>categories:<br>- Zookeeper<br>- SpringBoot<br>tags:<br>- SpringBoot<br>- Zookeeper</h2><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>zookeeper一般作为注册中心、配置中心等使用，对于此处的使用，spring cloud zookeeper有非常完善的api，引入相对于的pom即可</p>
<p>而在此处是对zookeeper的基础api进行简单的运用，也就是对zookeeper的节点运用，不涉及集群操作</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.zookeeper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zookeeper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zookeeper.apache.org/">详情参照</a></p>
<h2 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h2><p>zookeeper的节点存储为树形结构，并且其存在多种节点类型，这里只简单使用了持久节点和临时节点<br>持久节点为客户端一经创建，则会永久的存在与本地文件系统，除非客户端手动删除<br>临时节点与客户端的本次连接生命周期一致，连接断掉即自动删除节点，也可手动删除</p>
<p>需要注意的是临时节点下不能存在子节点</p>
<h2 id="代码使用"><a href="#代码使用" class="headerlink" title="代码使用"></a>代码使用</h2><p>属性值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/10 14:57</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = PropertiesPrefixConstant.ZK)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZkProperties</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> Integer timeout;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置: 此处的bean配置的为客户端的连接，Zookeeper的客户端对象作为单例存在于IOC容器，维持客户端连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/10 15:06</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnProperty(prefix = Constant.CONDITIONAL, name = &quot;zk&quot;, havingValue = &quot;true&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZookeeperConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOGGER</span> <span class="operator">=</span> LoggerFactory.getLogger(ZookeeperConfig.class);</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ZkProperties zkProperties;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> ZooKeeper <span class="title function_">zkClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ZooKeeper</span> <span class="variable">zooKeeper</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">CountDownLatch</span> <span class="variable">countDownLatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line">            zooKeeper = <span class="keyword">new</span> <span class="title class_">ZooKeeper</span>(zkProperties.getAddress(), zkProperties.getTimeout(), <span class="keyword">new</span> <span class="title class_">Watcher</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">process</span><span class="params">(WatchedEvent event)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (Event.KeeperState.SyncConnected == event.getState()) &#123;</span><br><span class="line">                        countDownLatch.countDown();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            countDownLatch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;zk init client for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> zooKeeper;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>API提供者</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> huangJie</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0v</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2022/10/10 15:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZkProducer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOGGER</span> <span class="operator">=</span> LoggerFactory.getLogger(ZkProducer.class);</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ZooKeeper zkClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建永久节点</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 节点路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data 节点的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true创建成功 false创建失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">createNode</span><span class="params">(String path, String data)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!existsNode(path)) &#123;</span><br><span class="line">                zkClient.create(path, data.getBytes(StandardCharsets</span><br><span class="line">                        .UTF_8), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;create zk node for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建临时节点</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data 数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true创建成功 false创建失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">createTmpNode</span><span class="params">(String path, String data)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!existsNode(path)) &#123;</span><br><span class="line">                zkClient.create(path, data.getBytes(StandardCharsets</span><br><span class="line">                        .UTF_8), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;create zk tmp node for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新节点数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 节点路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data 数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">updateNode</span><span class="params">(String path, String data)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (existsNode(path)) &#123;</span><br><span class="line">                zkClient.setData(path, data.getBytes(StandardCharsets.UTF_8), -<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;update for zk node data error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除节点</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 节点路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true成功 false失败</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteNode</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (existsNode(path)) &#123;</span><br><span class="line">                zkClient.delete(path, -<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;delete for zk node error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取子级节点</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 节点路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 子级结果集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">childrenNode</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> zkClient.getChildren(path, <span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;obtain node child for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取节点的数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 节点路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">dataGet</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (existsNode(path)) &#123;</span><br><span class="line">                <span class="type">byte</span>[] data = zkClient.getData(path, <span class="literal">true</span>, <span class="keyword">new</span> <span class="title class_">Stat</span>());</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(data);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;get zk node on data for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断节点是不是存在</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path zk节点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true存在 false不存在</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">existsNode</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> zkClient.exists(path, <span class="literal">true</span>) != <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">&quot;judge zk node whether exists for error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Zookeeper%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8/" data-id="clilg59gz002rbpowgoxx67mc" data-title="SpringBoot整合Zookeeper简单运用" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-开源框架/SpringCloud笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringCloud%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringCloud%E7%AC%94%E8%AE%B0/">SpringCloud笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h1><p><strong>服务注册中心<code>eureka-server</code></strong></p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8080</span></span><br><span class="line"><span class="attr">eureka.instance.hostname</span>=<span class="string">localhost</span></span><br><span class="line"><span class="comment">#是否注册到服务中心，本身就是注册中</span></span><br><span class="line"><span class="attr">eureka.client.register-with-eureka</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">eureka.client.fetch-registry</span>=<span class="string">false</span></span><br><span class="line"><span class="comment">#服务中心的名字地址</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">eureka-server</span></span><br></pre></td></tr></table></figure>

<p>启动类支持<code>@EnableEurekaServer</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubkeyOneApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SubkeyOneApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问<a href="http://localhost:8080即可看到所有已经注册的服务">http://localhost:8080即可看到所有已经注册的服务</a></p>
<hr>
<p><strong>服务注册</strong></p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8081</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">zuul-server</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br></pre></td></tr></table></figure>

<p>启动类支持</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br></pre></td></tr></table></figure>



<hr>
<p><strong>负载均衡：<code>Ribbon</code></strong></p>
<p>在使用<code>Ribbon</code>作为负载均衡的时候，需要手动注入一个<code>RestTemplate</code>的Bean到Ioc，并且为该Bean加入<code>@LoadBalanced</code>开启负载均衡，使其能够以查询到服务注册中心的服务。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@LoadBalanced</span></span><br><span class="line"><span class="keyword">public</span> RestTemplate <span class="title function_">getRestTemplate</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>负载均衡：<code>Feign</code></strong></p>
<p>使用<code>Feign</code>作为负载均衡的时候，需要先在启动类使用<code>@EnableFeignClients</code>来开启，而后创建一个接口，使用<code>@FeignClient(value = &quot;DATA-SERVER&quot;)</code>标签来指定访问的服务</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;DATA-SERVER&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IProductClientFeign</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/product/all&quot;)</span></span><br><span class="line">    List&lt;Product&gt; <span class="title function_">allProduct</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>配置服务<code>ConfigServer</code></strong></p>
<p>pom配置服务包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-config-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置文件<code>properties</code>，配置服务参数</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8030</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">config-server</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br><span class="line"><span class="attr">spring.cloud.config.label</span>=<span class="string">master</span></span><br><span class="line"><span class="attr">spring.cloud.config.server.git.uri</span>=<span class="string">https://github.com/Huangjie-Github/spring-cloud-config-server</span></span><br><span class="line"><span class="attr">spring.cloud.config.server.git.search-paths</span>=<span class="string">config</span></span><br><span class="line"><span class="attr">spring.cloud.config.server.git.username</span>=<span class="string">Huangjie-Github</span></span><br><span class="line"><span class="attr">spring.cloud.config.server.git.password</span>=<span class="string">h19981228j</span></span><br></pre></td></tr></table></figure>

<p>在启动类上开启服务</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableConfigServer</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>使用<code>ConfigServer</code></strong></p>
<p>pom引入服务使用包</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置文件中声明配置服务参数</p>
<p><strong>注意：</strong>在使用配置服务的时候，下列参数一定要新建一个bootstrap.properties&#x2F;bootstrap.yml的配置文件，因为bootstrap的配置文件会比application的配置文件先启动加载，需要先启动加载好配置服务才能进行本服务的相关数据注入</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#分支</span></span><br><span class="line"><span class="attr">spring.cloud.config.label</span>=<span class="string">master</span></span><br><span class="line"><span class="comment">#启用的模式</span></span><br><span class="line"><span class="attr">spring.cloud.config.profile</span>=<span class="string">dev</span></span><br><span class="line"><span class="comment">#是否发现启用</span></span><br><span class="line"><span class="attr">spring.cloud.config.discovery.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#注册中心的名称</span></span><br><span class="line"><span class="attr">spring.cloud.config.discovery.serviceId</span>=<span class="string">CONFIG-SERVER</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br></pre></td></tr></table></figure>

<p>配置之后，只需要在引用的类上使用<code>@RefreshScope</code>标签开启，需要引用的参数上使用<code>@Value</code>标签即可</p>
<hr>
<p><strong>消息总线bus：<code>RabbitMQ</code></strong></p>
<p>pom使用jar</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bus-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>配置文件修改</p>
<p>bootstrap.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#与配置服务绑定</span></span><br><span class="line"><span class="attr">spring.cloud.config.label</span>=<span class="string">master</span></span><br><span class="line"><span class="attr">spring.cloud.config.profile</span>=<span class="string">dev</span></span><br><span class="line"><span class="attr">spring.cloud.config.discovery.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.cloud.config.discovery.serviceId</span>=<span class="string">CONFIG-SERVER</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br><span class="line"><span class="comment">#bus总线配置</span></span><br><span class="line"><span class="attr">spring.cloud.bus.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">spring.cloud.bus.trace.enabled</span>=<span class="string">true</span></span><br><span class="line"><span class="comment">#配置RabbitMQ</span></span><br><span class="line"><span class="attr">spring.rabbitmq.host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="attr">spring.rabbitmq.port</span>=<span class="string">5672</span></span><br><span class="line"><span class="attr">spring.rabbitmq.username</span>=<span class="string">guest</span></span><br><span class="line"><span class="attr">spring.rabbitmq.password</span>=<span class="string">guest</span></span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8011</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">feign-server</span></span><br><span class="line"><span class="comment">#路线访问允许/actuator/refresh</span></span><br><span class="line"><span class="attr">management.endpoints.web.exposure.include</span>=<span class="string">*</span></span><br><span class="line"><span class="attr">management.endpoints.web.cors.allowed-origins</span>=<span class="string">*</span></span><br><span class="line"><span class="attr">management.endpoints.web.cors.allowed-methods</span>=<span class="string">*</span></span><br></pre></td></tr></table></figure>

<p>访问需要更新的微服务<a target="_blank" rel="noopener" href="http://localhost:801/actuator/refresh">http://localhost:801/actuator/refresh</a></p>
<p>该访问不支持Get访问，只支持Post访问</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        HashMap&lt;String,String&gt; headers =<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        headers.put(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json; charset=utf-8&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;因为要去git获取，还要刷新config-server, 会比较卡，所以一般会要好几秒才能完成，请耐心等待&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> HttpUtil.createPost(<span class="string">&quot;http://localhost:8012/actuator/bus-refresh&quot;</span>).addHeaders(headers).execute().body();</span><br><span class="line">        System.out.println(<span class="string">&quot;result:&quot;</span>+result);</span><br><span class="line">        System.out.println(<span class="string">&quot;refresh 完成&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>断路器<code>Hystrix</code></strong></p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span>   </span><br></pre></td></tr></table></figure>

<p>原来使用Feign做负载均衡的连接接口类修改其</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原来的</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;DATA-SERVER&quot;)</span></span><br><span class="line"><span class="comment">//修改之后的</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;DATA-SERVER&quot;,fallback = ProductClientFeignHystrixImpl.class)</span></span><br></pre></td></tr></table></figure>

<p><code>fallback</code>：回退，大概就是说，当指定的微服务不可用时，回退到指定类中的复写方法。因为指定的回退类是继承与当前的接口，那么必定需要继承当前的访问抽象方法。所以，在微服务不可用的时候，调用其复写的方法，做微服务不可用处理。</p>
<p>IProductClientFeign.class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;DATA-SERVER&quot;,fallback = ProductClientFeignHystrixImpl.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IProductClientFeign</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 请求数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 结果</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/product/all&quot;)</span></span><br><span class="line">    List&lt;Product&gt; <span class="title function_">allProduct</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ProductClientFeignHystrixImpl.class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProductClientFeignHystrixImpl</span> <span class="keyword">implements</span> <span class="title class_">IProductClientFeign</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Product&gt; <span class="title function_">allProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        ArrayList&lt;Product&gt; products = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        products.add(<span class="keyword">new</span> <span class="title class_">Product</span>(<span class="number">1</span>,<span class="string">&quot;数据服务不可用&quot;</span>,<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">return</span> products;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置完断路器之后，还需要去启动类中启用它<code>@EnableHystri</code>，以及去配置文件中开启相关服务操作<code>feign.hystrix.enabled=true</code></p>
<hr>
<p><strong>断路器监听<code>hystrix-dashboard</code></strong></p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--        连接服务注册中心--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        断路器监听--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        断路器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        环节映射--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>启动类上开启断路器监听</p>
<p><code>@EnableHystrixDashboard</code>：开启断路监听</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableHystrixDashboard</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HystrixMonitorServerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(HystrixMonitorServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8040</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">hystrix-monitor-server</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br></pre></td></tr></table></figure>

<p>给共享信息让监听器监听的微服务使用<code>@EnableCircuitBreaker</code>开启分享</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableHystrix</span></span><br><span class="line"><span class="meta">@EnableCircuitBreaker</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignServerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(FeignServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@SpringBootApplication</code>：SpeingBoot启动类<br><code>@EnableEurekaClient</code>：启用微服务注册连接，让注册中心发现，扫描该服务<br><code>@EnableFeignClients</code>：让注册中心发现这个Feign负载均衡的服务<br><code>@EnableDiscoveryClient</code>：<br><code>@EnableHystrix</code>：启用熔断<br><code>@EnableCircuitBreaker</code>：分享信息给熔断监听，本身必须要有熔断机制</p>
<p>访问地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8040/hystrix">http://localhost:8040/hystrix</a></p>
<p>监听地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8011/actuator/hystrix.stream">http://localhost:8011/actuator/hystrix.stream</a></p>
<hr>
<p>断路器聚合监听</p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-turbine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8050</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">hystrix-turbine-server</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br><span class="line"></span><br><span class="line"><span class="attr">turbine.aggregator.cluster-config</span>=<span class="string">default</span></span><br><span class="line"><span class="comment">#配置Eureka中的serviceId列表，表明监控哪些服务</span></span><br><span class="line"><span class="attr">turbine.app-config</span>=<span class="string">feign-server</span></span><br><span class="line"><span class="attr">turbine.cluster-name-expression</span>= <span class="string">new String(&quot;default&quot;)</span></span><br></pre></td></tr></table></figure>

<p>启动类开启</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableTurbine</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HystrixTurbineServerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(HystrixTurbineServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用上面的熔断监听服务去获得监听服务</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8040/hystrix%E3%80%81">http://localhost:8040/hystrix、</a></p>
<p>输入聚合监听的端口地址进行局和监听</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8050/turbine.stream">http://localhost:8050/turbine.stream</a></p>
<hr>
<p><strong>网关<code>zuul</code></strong></p>
<p>pom支持</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-zuul<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port</span>=<span class="string">8060</span></span><br><span class="line"><span class="attr">spring.application.name</span>=<span class="string">zuul-server</span></span><br><span class="line"><span class="attr">eureka.client.service-url.defaultZone</span>=<span class="string">http://localhost:8080/eureka</span></span><br><span class="line"><span class="comment">#映射</span></span><br><span class="line"><span class="attr">zuul.routes.api-a.path</span>=<span class="string">/api-data/**</span></span><br><span class="line"><span class="attr">zuul.routes.api-a.service-id</span>=<span class="string">DATA-SERVER</span></span><br><span class="line"><span class="attr">zuul.routes.api-b.path</span>=<span class="string">/api-feign/**</span></span><br><span class="line"><span class="attr">zuul.routes.api-b.service-id</span>=<span class="string">FEIGN-SERVER</span></span><br></pre></td></tr></table></figure>

<p>启动类开启网关注册<code>@EnableZuulProxy</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableZuulProxy</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZuulServerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(ZuulServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8060/api-feign/feign/all">http://localhost:8060/api-feign/feign/all</a></p>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringCloud%E7%AC%94%E8%AE%B0/" data-id="clilg59gz002sbpow1be70foz" data-title="SpringCloud笔记" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/hexo-web/page/3/">&laquo; 上一页</a><a class="page-number" href="/hexo-web/">1</a><a class="page-number" href="/hexo-web/page/2/">2</a><a class="page-number" href="/hexo-web/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/hexo-web/page/5/">5</a><a class="page-number" href="/hexo-web/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/hexo-web/page/9/">9</a><a class="extend next" rel="next" href="/hexo-web/page/5/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/C-%E5%9F%BA%E7%A1%80/">C++基础</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%89%8D%E7%AB%AF%E6%9D%82%E7%83%A9/">前端杂烩</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB/">理论体系</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/">脚本语言</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E8%99%9A%E6%8B%9F%E5%AE%B9%E5%99%A8/">虚拟容器</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/hexo-web/archives/2023/06/">六月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/">C++内存分配</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">C++基础语法</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E8%AF%AD%E6%B3%95_%E7%BB%A7%E6%89%BF/">C++语法_继承</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/IO%E4%B8%8ENIO/">IO与NIO</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jar%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/">Jar后台运行</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 ajiehome<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/hexo-web/" class="mobile-nav-link">Home</a>
  
    <a href="/hexo-web/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/hexo-web/js/jquery-3.6.4.min.js"></script>



  
<script src="/hexo-web/fancybox/jquery.fancybox.min.js"></script>




<script src="/hexo-web/js/script.js"></script>





  </div>
</body>
</html>