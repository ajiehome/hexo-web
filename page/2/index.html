<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>阿杰之家</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="山有扶苏，隰有荷华">
<meta property="og:type" content="website">
<meta property="og:title" content="阿杰之家">
<meta property="og:url" content="http://ajiehome.online/page/2/index.html">
<meta property="og:site_name" content="阿杰之家">
<meta property="og:description" content="山有扶苏，隰有荷华">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="ajiehome">
<meta property="article:tag" content="ajiehome">
<meta property="article:tag" content="阿杰之家">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/hexo-web/atom.xml" title="阿杰之家" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/hexo-web/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/hexo-web/css/style.css">

  
    
<link rel="stylesheet" href="/hexo-web/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/hexo-web/" id="logo">阿杰之家</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/hexo-web/" id="subtitle">山有扶苏，隰有荷华</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/hexo-web/">Home</a>
        
          <a class="main-nav-link" href="/hexo-web/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/hexo-web/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://ajiehome.online"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Java基础/Java的HashMap" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84HashMap/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84HashMap/">Java的HashMap</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="关于集合中的hashmap"><a href="#关于集合中的hashmap" class="headerlink" title="关于集合中的hashmap"></a>关于集合中的hashmap</h1><p>关于tableSizeFor方法：Returns a power of two size for the given target capacity.返回当前数的最小二次幂</p>
<p>默认初始化的hashmap大小为16个大小，默认的负载系数为0.75<br>负载系数的计算公式：f &#x3D; 当前实际数目 &#x2F; hashmap总数目<br>也就是说当存入的数目大于等于总容量乘以负载系数的时候就会进扩容操作<br>如果负载系数大于或者等于了规定的负载系数，则会进行hashmap的扩容</p>
<p>get、put：先求hash值，然后右移16位做高位对比，求出hash之后通过hash找到指定的桶，当发生hash冲突的时候，会在同一个桶内存在多个节点，当我们的节点数超过了8个的时候，会做红黑树与链表的转换</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;</span><br><span class="line"> p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line"> <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">   treeifyBin(tab, hash); <span class="comment">//红黑树转换</span></span><br><span class="line"> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TREEIFY_THRESHOLD默认值为8，为树型阈值，在8以内使用链表，在8以外使用红黑树</p>
<p>hash表里面所用的hashcode方法中的<code>Objects.hashCode(key)</code>，都取自于Object的hashcode方法，而Object的hashcode方法的标注是<code>public native int hashCode();</code>，native是java与其他编程语言进行交互的声明保留字段，也就是说这里的hashCode()方法其实调用的是C&#x2F;C++的hashCode的计算hash值</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84HashMap/" data-id="clilhdwaj000rb7os125xfvun" data-title="Java的HashMap" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/Java的Vector" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84Vector/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84Vector/">Java的Vector</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h1><p>vector的存储单元是数组，在没有指定默认大小的时候，默认初始大小是10，vector和ArrayList的最大区别在线程安全</p>
<p>构造方法有：</p>
<ul>
<li>全参数构造：1、初始化大小，2、扩容大小</li>
<li>单参构造：初始化大小，扩容大小为0</li>
<li>无参构造：</li>
<li>集合参数：传入一个Collection的子类，进行拷贝创建</li>
</ul>
<p>扩容操作：Vector的扩容大小是基于扩容大小参数的，如果扩容参数为0就成倍扩大，否则就按照参数</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E7%9A%84Vector/" data-id="clilhdwal000ub7os02fges4t" data-title="Java的Vector" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/Java计算文件MD5" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6MD5/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6MD5/">Java计算文件MD5</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="计算文件的MD5"><a href="#计算文件的MD5" class="headerlink" title="计算文件的MD5"></a>计算文件的MD5</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">md5</span><span class="params">(File file)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md5</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">stream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">byte</span> [] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((read=(fileInputStream.read(bytes)))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                stream.write(bytes,<span class="number">0</span>,read);</span><br><span class="line">            &#125;</span><br><span class="line">            fileInputStream.close();</span><br><span class="line">            stream.close();</span><br><span class="line">            <span class="type">byte</span>[] byteArray = stream.toByteArray();</span><br><span class="line">            md5.update(byteArray);</span><br><span class="line">            <span class="type">byte</span>[] digest = md5.digest();</span><br><span class="line">            <span class="type">BigInteger</span> <span class="variable">bigInteger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="number">1</span>,digest);</span><br><span class="line">            <span class="comment">//生成MD5的进制数</span></span><br><span class="line">            <span class="keyword">return</span> bigInteger.toString(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException | IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApplicationException</span>(CodeType.SERVICE_ERROR, <span class="string">&quot;MD5转换失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Java%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6MD5/" data-id="clilhdwam000vb7osccnxd2cj" data-title="Java计算文件MD5" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/Jvm内存结构" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/">Jvm内存结构</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JVM内存结构"><a href="#JVM内存结构" class="headerlink" title="JVM内存结构"></a><code>JVM</code>内存结构</h1><p>Java虚拟机分为五个部分：程序计数器、Java虚拟机栈、本地方法栈、堆、方法区</p>
<p><img src="https://camo.githubusercontent.com/9ab34e9114814b84731635c2b2cc2abd0084edc44d220602948742aa8ad83340/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f646f6f63732f6a766d406d61696e2f696d616765732f6a766d2d6d656d6f72792d7374727563747572652e6a7067"></p>
<p><strong>程序计数器（PC寄存器）</strong></p>
<p>定义：</p>
<ul>
<li>程序计数器是一块较小内存空间，是当前线程执行那条字节码的所在地址，如果当前线程正在执行的是一个本地方法（Native），那么此程序计数器为Undefined。</li>
</ul>
<p>作用：</p>
<ul>
<li>字节码解读器通过切换程序计数器的顺序，来改变当前执行的指令，从而实现程序的流程控制</li>
<li>在多线程的情况下，线程计数器记录的是当前线程的执行位置，当线程切换回来的时候，就知道上次线程的执行位置</li>
</ul>
<p>特点：</p>
<ul>
<li>是一块较小的空间</li>
<li>线程私有，每个线程都有自己的程序计数器</li>
<li>生命周期随着线程的诞生而诞生，随着线程的销毁而销毁</li>
<li>是唯一一个不会出现<code>OutOfMemoryError</code>的内存区域</li>
</ul>
<p><strong>Java虚拟机栈（Java栈）</strong></p>
<p><img src="https://camo.githubusercontent.com/109d4eff5b60971060cef6cb1e7923e274771d5e1655e0e5aabaf40df9f9aa6a/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f646f6f63732f6a766d406d61696e2f696d616765732f6a766d2d737461636b2e6a7067"></p>
<p>定义：</p>
<ul>
<li>Java虚拟机栈是描述Java方法运行过程的内存模型，Java虚拟机栈会为每一个即将运行的方法创建一块帧栈内存，用于存放该方法运行过程中的一些信息，如局部变量表、操作数栈、动态链接、方法出口信息</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84/" data-id="clilhdwan000yb7os9xun7y03" data-title="Jvm内存结构" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/Jvm垃圾收集器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/">Jvm垃圾收集器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="垃圾收集器"><a href="#垃圾收集器" class="headerlink" title="垃圾收集器"></a>垃圾收集器</h1><p>新生代垃圾收集器</p>
<p>Serial垃圾收集器：是单线程的收集器，并且在垃圾收集的时候需要暂停所有的用户线程</p>
<p>ParNew垃圾收集器：是Serial收集器的多线程版本，在垃圾收集的时候一样需要暂停所有的用户线程，在多CPU条件下性能比Serial收集器要好，但是由于线程切换需要损耗一定的资源，所以在单CPU的环境下，性能不如Serial好</p>
<p>Parallel Scavenge垃圾收集器：</p>
<p>​	</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/" data-id="clilhdwao0010b7oshhameojr" data-title="Jvm垃圾收集器" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/Jvm虚拟机" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E8%99%9A%E6%8B%9F%E6%9C%BA/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E8%99%9A%E6%8B%9F%E6%9C%BA/">Jvm虚拟机</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="JVM虚拟机"><a href="#JVM虚拟机" class="headerlink" title="JVM虚拟机"></a>JVM虚拟机</h1><p>指针碰撞（bump the pointer）： 指在分配内存的时候，由于堆空间的内存是整齐规划的，一边是使用的内存，一边是空闲的内存，中间由指针分开，在移动指针进行内存分配的时候叫做内存分配</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jvm%E8%99%9A%E6%8B%9F%E6%9C%BA/" data-id="clilhdwaq0013b7osdhi1f5jk" data-title="Jvm虚拟机" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/二维码生成" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E4%BA%8C%E7%BB%B4%E7%A0%81%E7%94%9F%E6%88%90/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E4%BA%8C%E7%BB%B4%E7%A0%81%E7%94%9F%E6%88%90/">二维码生成</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Zxing"><a href="#Zxing" class="headerlink" title="Zxing"></a>Zxing</h1><h3 id="POM文件的引入"><a href="#POM文件的引入" class="headerlink" title="POM文件的引入"></a>POM文件的引入</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.zxing<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javase<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="后端Controller的port代码"><a href="#后端Controller的port代码" class="headerlink" title="后端Controller的port代码"></a>后端Controller的port代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PortMapping(&quot;/qrCode/&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">qrCode</span><span class="params">(<span class="meta">@RequestParam(&quot;centext&quot;)</span>String centext, HttpServletResponse response, HttpServletRequest request)</span>&#123;</span><br><span class="line">       Map&lt;EncodeHintType, Object&gt; hints = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);</span><br><span class="line">       hints.put(EncodeHintType.CHARACTER_SET,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">       hints.put(EncodeHintType.ERROR_CORRECTION, ErrorCorrectionLevel.H);</span><br><span class="line">       hints.put(EncodeHintType.MARGIN,<span class="number">1</span>);</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           response.setContentType(<span class="string">&quot;image/png;charset=UTF-8&quot;</span>);</span><br><span class="line">           <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">           <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">           <span class="type">BitMatrix</span> <span class="variable">bitMatrix</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MultiFormatWriter</span>().encode(context, BarcodeFormat.QR_CODE, <span class="number">200</span>, <span class="number">200</span>, hints);</span><br><span class="line">           MatrixToImageWriter.writeToStream(bitMatrix,<span class="string">&quot;png&quot;</span>,byteArrayOutputStream);</span><br><span class="line">  <span class="comment">//编码格式转换，由于前端用ajax设置img标签的src属性需要</span></span><br><span class="line"> response.getOutputStream().write(Base64.encodeBase64(byteArrayOutputStream.toByteArray()));</span><br><span class="line">           outputStream.flush();</span><br><span class="line">           outputStream.close();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (WriterException | IOException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//枚举内容替换成了字符串，不好展示</span></span><br><span class="line">       <span class="keyword">return</span> &#123;<span class="string">&quot;code&quot;</span>:<span class="number">2001</span>,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;二维码生成成功&quot;</span>&#125;;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="前端js代码"><a href="#前端js代码" class="headerlink" title="前端js代码"></a>前端js代码</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">           $(<span class="string">&quot;#showQRCode&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">               <span class="keyword">let</span> inputText = $(<span class="string">&quot;#inputText&quot;</span>).<span class="title function_">val</span>();</span><br><span class="line">               $.<span class="title function_">port</span>(&#123;</span><br><span class="line">                   <span class="attr">url</span>: <span class="string">&quot;/qrCode&quot;</span>,</span><br><span class="line">                   <span class="attr">data</span>: &#123;<span class="string">&quot;context&quot;</span>:inputText&#125;,</span><br><span class="line">                   <span class="attr">dataType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">                   <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">                   <span class="attr">responseType</span>: <span class="string">&quot;blob&quot;</span>,</span><br><span class="line">                   <span class="attr">accept</span>:<span class="string">&quot;image/png&quot;</span>,</span><br><span class="line">                   <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">response</span>)&#123;</span><br><span class="line">                       <span class="comment">//后台的Base64编码作用于这里</span></span><br><span class="line">                       $(<span class="string">&quot;#qrCode&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;data:image/png;base64,&quot;</span>+response);</span><br><span class="line">                   &#125;,</span><br><span class="line">                   <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                       <span class="title function_">alert</span>(<span class="string">&quot;请求错误&quot;</span>);</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;)</span><br><span class="line">           &#125;);</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="前端HTML代码"><a href="#前端HTML代码" class="headerlink" title="前端HTML代码"></a>前端HTML代码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span>  <span class="attr">id</span>=<span class="string">&quot;qrCode&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-left: 20px&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;QRCode&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;inputText&quot;</span>&gt;</span>输入二维码内容：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;inputText&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;showQRCode&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><p>*使用<strong>Zxing</strong>第三方jar包，使用<strong>MultiFormatWriter</strong>的<strong>encode()<strong>方法生成一个二维码类</strong>BitMatrix</strong>的对象，然后用<strong>MatrixToImageWriter</strong>的流写入方法<strong>writeToStream()<strong>以</strong>png</strong>的形式写入<strong>OutputStresam</strong>流中，如果需要，可以进行相应的编码转换。*</p>
<p><em><strong>如果使用get的方式，直接往img标签的src属性添加生成二维码的访问地址即可，并且不需要base64编码。</strong></em></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E4%BA%8C%E7%BB%B4%E7%A0%81%E7%94%9F%E6%88%90/" data-id="clilhdwar0015b7osgmjy8i8j" data-title="二维码生成" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Java基础/计算文件的MD5" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6%E7%9A%84MD5/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6%E7%9A%84MD5/">计算文件的MD5</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="title-计算文件的MD5date-2022-04-20-09-41-15-031updated-2022-10-13-14-57-26-724url-x2F-archives-x2F-ji-suan-wen-jian-de-md5categories-Javatags-Java-MD5"><a href="#title-计算文件的MD5date-2022-04-20-09-41-15-031updated-2022-10-13-14-57-26-724url-x2F-archives-x2F-ji-suan-wen-jian-de-md5categories-Javatags-Java-MD5" class="headerlink" title="title: 计算文件的MD5date: 2022-04-20 09:41:15.031updated: 2022-10-13 14:57:26.724url: &#x2F;archives&#x2F;ji-suan-wen-jian-de-md5categories:- Javatags:- Java- MD5"></a>title: 计算文件的MD5<br>date: 2022-04-20 09:41:15.031<br>updated: 2022-10-13 14:57:26.724<br>url: &#x2F;archives&#x2F;ji-suan-wen-jian-de-md5<br>categories:<br>- Java<br>tags:<br>- Java<br>- MD5</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">md5</span><span class="params">(File file)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md5</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">stream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">byte</span> [] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> ((read=(fileInputStream.read(bytes)))!=-<span class="number">1</span>)&#123;</span><br><span class="line">                stream.write(bytes,<span class="number">0</span>,read);</span><br><span class="line">            &#125;</span><br><span class="line">            fileInputStream.close();</span><br><span class="line">            stream.close();</span><br><span class="line">            <span class="type">byte</span>[] byteArray = stream.toByteArray();</span><br><span class="line">            md5.update(byteArray);</span><br><span class="line">            <span class="type">byte</span>[] digest = md5.digest();</span><br><span class="line">            <span class="type">BigInteger</span> <span class="variable">bigInteger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="number">1</span>,digest);</span><br><span class="line">            <span class="comment">//生成MD5的进制数</span></span><br><span class="line">            <span class="keyword">return</span> bigInteger.toString(<span class="number">16</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException | IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ApplicationException</span>(CodeType.SERVICE_ERROR, <span class="string">&quot;MD5转换失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/Java%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6%E7%9A%84MD5/" data-id="clilhdwas0018b7os7hlegpba" data-title="计算文件的MD5" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-中间件/Kafka安装" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka%E5%AE%89%E8%A3%85/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka%E5%AE%89%E8%A3%85/">Kafka安装</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>首先下载Kafka的二进制包，以及Kafka-Manager Cmak工具</p>
<p><a target="_blank" rel="noopener" href="https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz">Kafka</a>(<a target="_blank" rel="noopener" href="https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz">https://downloads.apache.org/kafka/3.3.1/kafka_2.13-3.3.1.tgz</a>)</p>
<p><a target="_blank" rel="noopener" href="https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip">Cmak</a>(<a target="_blank" rel="noopener" href="https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip">https://github.com/yahoo/CMAK/releases/download/3.0.0.6/cmak-3.0.0.6.zip</a>)</p>
<p>解压Kafka到<code>/opt</code>目录shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf kafka_2.13-3.3.1.tgz -C /opt</span><br></pre></td></tr></table></figure>

<p>解压Cmak到<code>/opt</code>目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip cmak-3.0.0.6 -C /opt</span><br></pre></td></tr></table></figure>

<p>修改cmak的application.properties<code>/opt/cmak-3.0.0.6/conf/application.properties</code>的如下信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The address the socket server listens on. If not configured, the host name will be equal to the value of</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">java.net.InetAddress.getCanonicalHostName(), with PLAINTEXT listener name, and port 9092.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  FORMAT:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    listeners = listener_name://host_name:port</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  EXAMPLE:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    listeners = PLAINTEXT://your.host.name:9092</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">listeners=PLAINTEXT://:9092</span></span><br><span class="line"></span><br><span class="line">listeners=PLAINTEXT://10.254.0.2:9092</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Listener name, hostname and port the broker will advertise to clients.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If not <span class="built_in">set</span>, it uses the value <span class="keyword">for</span> <span class="string">&quot;listeners&quot;</span>.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">advertised.listeners=PLAINTEXT://your.host.name:9092</span></span><br><span class="line">advertised.listeners=PLAINTEXT://10.254.0.2:9092</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Settings prefixed with <span class="string">&#x27;kafka-manager.&#x27;</span> will be deprecated, use <span class="string">&#x27;cmak.&#x27;</span> instead.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://github.com/yahoo/CMAK/issues/713</span></span><br><span class="line">kafka-manager.zkhosts=&quot;kafka-manager-zookeeper:2181&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">kafka-manager.zkhosts=<span class="variable">$&#123;?ZK_HOSTS&#125;</span></span></span><br><span class="line">kafka-manager.zkhosts=&quot;10.254.0.2:2181&quot;</span><br><span class="line">cmak.zkhosts=&quot;kafka-manager-zookeeper:2181&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">cmak.zkhosts=<span class="variable">$&#123;?ZK_HOSTS&#125;</span></span></span><br><span class="line">cmak.zkhosts=&quot;10.254.0.2:2181&quot;</span><br></pre></td></tr></table></figure>

<p>构建如下脚本，一键启动Kafka所需要的Zookeeper服务、Kafka服务以及Cmak管理工具</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">option=$1</span><br><span class="line"></span><br><span class="line">echo &quot;option $option&quot;</span><br><span class="line"></span><br><span class="line">case $option in </span><br><span class="line"></span><br><span class="line">  &#x27;start&#x27;)</span><br><span class="line"></span><br><span class="line">    # create kafka catalogue</span><br><span class="line">    if [ -d &#x27;/root/kafka&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka catalogue exists&#x27;</span><br><span class="line">    else </span><br><span class="line">      mkdir /root/kafka</span><br><span class="line">      echo &#x27;create kafka catalogue success&#x27;</span><br><span class="line">    fi</span><br><span class="line">    # create kafka log catalogue</span><br><span class="line">    if [ -d &quot;/root/kafka/log&quot; ]; then</span><br><span class="line">      echo &#x27;kafka log catalogue exists&#x27;</span><br><span class="line">    else</span><br><span class="line">      mkdir /root/kafka/log</span><br><span class="line">      echo &#x27;create kafka log catalogue success&#x27;</span><br><span class="line">    fi</span><br><span class="line">    #  create kafka pid catalogue</span><br><span class="line">    if [ -d &#x27;/root/kafka/pid&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka pid catalogue exists&#x27;</span><br><span class="line">    else</span><br><span class="line">      mkdir /root/kafka/pid</span><br><span class="line">      echo &#x27;create kafka pid catalogue success&#x27;</span><br><span class="line">    fi</span><br><span class="line">    # creare kafka zk log file </span><br><span class="line">    if [ -f &#x27;/root/kafka/log/zk.log&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka zk log file already exists&#x27;</span><br><span class="line">    else </span><br><span class="line">      touch /root/kafka/log/zk.log</span><br><span class="line">      echo &#x27;create kafka zk log file success&#x27;</span><br><span class="line">    fi</span><br><span class="line">    # create zk pid file </span><br><span class="line">    if [ -f &#x27;/root/kafka/pid/zk-pid&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka zk pid file already exists&#x27;</span><br><span class="line">    else</span><br><span class="line">      touch /root/kafka/pid/zk-pid</span><br><span class="line">      echo &#x27;create kafka zk pid file success&#x27;</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    nohup  /opt/kafka_2.13-3.3.1/bin/zookeeper-server-start.sh /opt/kafka_2.13-3.3.1/config/zookeeper.properties &gt; /root/kafka/log/zk.log 2&gt;&amp;1 &amp;</span><br><span class="line">    echo $!</span><br><span class="line">    echo $! &gt; /root/kafka/pid/zk-pid</span><br><span class="line">    echo &#x27;loading 1 minute ......&#x27; </span><br><span class="line">    sleep 1m</span><br><span class="line"></span><br><span class="line">    # create kafka server log file</span><br><span class="line">    if [ -f &#x27;/root/kafka/log/kafka.log&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka server log file exists&#x27;</span><br><span class="line">    else </span><br><span class="line">      touch /root/kafka/log/kafka.log</span><br><span class="line">      echo &#x27;create kafka server log file success&#x27;</span><br><span class="line">    fi</span><br><span class="line">    # create kafka pid pid file</span><br><span class="line">    if [ -f &#x27;/root/kafka/pid/kafka-pid&#x27; ]; then</span><br><span class="line">      echo &#x27;kafka server pid file exists&#x27;</span><br><span class="line">    else</span><br><span class="line">      touch /root/kafka/pid/kafka-pid</span><br><span class="line">      echo &#x27;create kafka server pid file success&#x27;</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    export JMX_PORT=9999</span><br><span class="line"></span><br><span class="line">    nohup /opt/kafka_2.13-3.3.1/bin/kafka-server-start.sh /opt/kafka_2.13-3.3.1/config/server.properties &gt; /root/kafka/log/kafka.log 2&gt;&amp;1 &amp;</span><br><span class="line">    echo $!</span><br><span class="line">    echo $! &gt; /root/kafka/pid/kafka-pid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # create kafka-manager cmak log file</span><br><span class="line">      if [ -f &#x27;/root/kafka/log/cmak.log&#x27; ]; then</span><br><span class="line">        echo &#x27;kafka manager cmak log file exists&#x27;</span><br><span class="line">      else</span><br><span class="line">        touch /root/kafka/log/cmak.log</span><br><span class="line">        echo &#x27;create kafka manager cmak log file success&#x27;</span><br><span class="line">      fi</span><br><span class="line">    # create kafka-manager cmak pid file</span><br><span class="line">     if [ -f &#x27;/root/kafka/pid/cmak-pid&#x27; ]; then</span><br><span class="line">       echo &#x27;kafka manager cmak pid file exists&#x27;</span><br><span class="line">     else </span><br><span class="line">       touch /root/kafka/pid/cmak-pid</span><br><span class="line">       echo &#x27;create kafka manager cmak pid file success&#x27;</span><br><span class="line">     fi</span><br><span class="line"></span><br><span class="line">    nohup bash /opt/cmak-3.0.0.6/bin/cmak &gt; /root/kafka/log/cmak.log 2&gt;&amp;1 &amp;</span><br><span class="line">    echo $!</span><br><span class="line">    echo $! &gt; /root/kafka/pid/cmak-pid</span><br><span class="line"></span><br><span class="line">    echo &#x27;loading 1 minute ......&#x27;</span><br><span class="line">    sleep 1m</span><br><span class="line">    echo &#x27;all server start success&#x27;</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  &#x27;stop&#x27;)</span><br><span class="line">    zk_pid=$(cat /root/kafka/pid/zk-pid)</span><br><span class="line">    kill -9 $zk_pid</span><br><span class="line">    echo &#x27;kill zookeeper server success&#x27;</span><br><span class="line"></span><br><span class="line">    kafka_pid=$(cat /root/kafka/pid/kafka-pid)</span><br><span class="line">    kill -9 $kafka_pid</span><br><span class="line">    echo &#x27;kill kafka server success&#x27;</span><br><span class="line"></span><br><span class="line">    cmak_pid=$(cat /root/kafka/pid/cmak-pid)</span><br><span class="line">    kill -9 $cmak_pid</span><br><span class="line">    echo &#x27;kill kafka manager cmak success&#x27;     </span><br><span class="line">    rm -rf /opt/cmak-3.0.0.6/RUNNING_PID</span><br><span class="line">  ;;</span><br><span class="line"></span><br><span class="line">  *)</span><br><span class="line">    echo &#x27;option error&#x27;</span><br><span class="line">  ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka%E5%AE%89%E8%A3%85/" data-id="clilhdwat001ab7osdtsu6fif" data-title="Kafka安装" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-中间件/RocketMQ与Systemd" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/hexo-web/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E4%B8%8ESystemd/" class="article-date">
  <time class="dt-published" datetime="2023-06-07T07:58:40.000Z" itemprop="datePublished">2023-06-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/hexo-web/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/hexo-web/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E4%B8%8ESystemd/">RocketMQ与Systemd</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="RocketMQ与Systemd"><a href="#RocketMQ与Systemd" class="headerlink" title="RocketMQ与Systemd"></a>RocketMQ与Systemd</h1><p>RocketMQ的安装比较简单，只需要提供了JAVA_HOME环境，之后运行对于的脚本即可，所以这里主要介绍的RocketMQ与Systemd的配置，结合Shell脚本，一次性的启用namsesrv和borker以及web管理工具<code>rocketmq-dashboard</code></p>
<h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>Java: openjdk-11</p>
<p>RocketMQ: <code>rocketmq-all-5.0.0-bin-release.zip</code><a target="_blank" rel="noopener" href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/5.0.0/rocketmq-all-5.0.0-bin-release.zip">下载</a></p>
<p>RocketMQ Dashboard: <code>rocketmq-dashboard-rocketmq-dashboard-1.0.0.tar.gz</code> <a target="_blank" rel="noopener" href="https://github.com/apache/rocketmq-dashboard">源码地址,该项目需要自己编译成jar包</a></p>
<p>在下载了RocketMQ的二进制包之后，解压到指定位置，而后配置对于的<code>namesrv</code>和<code>borker</code>服务，systemd的服务配置在<code>/usr/lib/systemd/system/</code>或者<code>/etc/systemd/system/</code>目录下</p>
<p>rmq_namesrv.service</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=rocketmq namesrv</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/opt/rocketmq-all-5.0.0-bin-release/bin/mqnamesrv</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">ExecStop=//opt/rocketmq-all-5.0.0-bin-release/bin/mqshutdown namesrv</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=mulitiple-rmq-namesrv.target</span><br></pre></td></tr></table></figure>

<p>rmq_borker.service</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=rocketmq broker</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/opt/rocketmq-all-5.0.0-bin-release/bin/mqbroker -n localhost:9876 --enable-proxy</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">ExecStop=/opt/rocketmq-all-5.0.0-bin-release/bin/mqshutdown broker</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multiple-rmq-broker.target</span><br></pre></td></tr></table></figure>

<p>在配置了这两个服务之后，即可通过systemctl start&#x2F;stop&#x2F;restart来执行服务了，由于每次都需要启动<code>namesrv</code>和<code>borker</code>服务还有web管理工具过于麻烦，所以引入<code>shell</code>脚本进行处理</p>
<p>rocketmq.shell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">instruct=$1</span><br><span class="line"></span><br><span class="line">echo $instruct</span><br><span class="line"></span><br><span class="line">case $instruct in</span><br><span class="line"> &#x27;start&#x27;)</span><br><span class="line">   systemctl start rmq_namesrv</span><br><span class="line">   systemctl start rmq_borker</span><br><span class="line">   export NAMSESRV_ADDR=localhost:9876</span><br><span class="line">   nohup java -jar /opt/rocketmq-dashboard-rocketmq-dashboard-1.0.0/target/rocketmq-dashboard-1.0.0.jar &gt; /root/rocketmq-dashboard.log &amp;</span><br><span class="line">   echo $! &gt; /root/rmq-d-pid</span><br><span class="line">   echo &quot;RocketMQ Start SUCCESS PID: &quot; + $!</span><br><span class="line"> ;;</span><br><span class="line"></span><br><span class="line"> &#x27;stop&#x27;)</span><br><span class="line">   systemctl stop rmq_namesrv</span><br><span class="line">   systemctl stop rmq_borker</span><br><span class="line">   PID=$(cat /root/rmq-d-pid)</span><br><span class="line">   kill -9 $&#123;PID&#125;</span><br><span class="line">   echo &quot;RocketMQ Stop SUCCESS&quot;</span><br><span class="line"> ;;</span><br><span class="line"></span><br><span class="line"> *)</span><br><span class="line">   echo &quot;Input instruct error&quot;</span><br><span class="line"> ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<p>可以通过执行该shell脚本对RocketMQ进行启动和关闭</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://ajiehome.online/2023/06/07/%E4%B8%AD%E9%97%B4%E4%BB%B6/RocketMQ%E4%B8%8ESystemd/" data-id="clilhdwax001db7os5mqxby2p" data-title="RocketMQ与Systemd" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/hexo-web/">&laquo; 上一页</a><a class="page-number" href="/hexo-web/">1</a><span class="page-number current">2</span><a class="page-number" href="/hexo-web/page/3/">3</a><a class="page-number" href="/hexo-web/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/hexo-web/page/9/">9</a><a class="extend next" rel="next" href="/hexo-web/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/C-%E5%9F%BA%E7%A1%80/">C++基础</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%89%8D%E7%AB%AF%E6%9D%82%E7%83%A9/">前端杂烩</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">开源框架</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB/">理论体系</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/">脚本语言</a></li><li class="category-list-item"><a class="category-list-link" href="/hexo-web/categories/%E8%99%9A%E6%8B%9F%E5%AE%B9%E5%99%A8/">虚拟容器</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/hexo-web/archives/2023/06/">六月 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/">C++内存分配</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/">C++基础语法</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/C++%E5%9F%BA%E7%A1%80/C++%E8%AF%AD%E6%B3%95_%E7%BB%A7%E6%89%BF/">C++语法_继承</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/IO%E4%B8%8ENIO/">IO与NIO</a>
          </li>
        
          <li>
            <a href="/hexo-web/2023/06/07/Java%E5%9F%BA%E7%A1%80/Jar%E5%90%8E%E5%8F%B0%E8%BF%90%E8%A1%8C/">Jar后台运行</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 ajiehome<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/hexo-web/" class="mobile-nav-link">Home</a>
  
    <a href="/hexo-web/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/hexo-web/js/jquery-3.6.4.min.js"></script>



  
<script src="/hexo-web/fancybox/jquery.fancybox.min.js"></script>




<script src="/hexo-web/js/script.js"></script>





  </div>
</body>
</html>