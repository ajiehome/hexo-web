
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8" />
        <title>阿杰之家</title>
        <meta name="author" content="ajiehome" />
        <meta name="description" content="山有扶苏，隰有荷华" />
        <meta name="keywords" content="ajiehome,阿杰之家" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
        <link rel="icon" href="https://static-argvchs.netlify.app/images/favicon.png" />
        <script src="https://static-argvchs.netlify.app/libs/vue/3.2.47/vue.global.prod.min.js"></script>
<link rel="preconnect" href="https://static-argvchs.netlify.app" crossorigin />
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/font-awesome/6.3.0/css/all.min.css" />
<link rel="stylesheet" href="https://static-argvchs.netlify.app/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://static-argvchs.netlify.app/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://static-argvchs.netlify.app/libs/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/js/lib/highlight.js"></script>


<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/katex.min.js"></script>
<script src="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://static-argvchs.netlify.app/libs/KaTeX/0.16.4/katex.min.css" />
<script src="/js/lib/math.js"></script>


<script src="/js/lib/preview.js"></script>





<script src="/js/lib/home.js"></script>

<script src="https://static-argvchs.netlify.app/libs/animejs/3.2.1/anime.min.js"></script>
<link rel="stylesheet" href="/css/main.css" />

    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
                <div id="loading" v-show="loading">
                    <div id="loading-circle">
                        <h2>LOADING</h2>
                        <p>加载过慢请开启缓存 浏览器默认开启</p>
                        <img src="/images/loading.gif" />
                    </div>
                </div>
            </transition>
            <nav id="menu" :class="{ hidden: hiddenMenu, 'menu-color': menuColor}">
    <div id="desktop-menu">
        <a class="title" href="/">
            <span>阿杰之家</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="title" @click="showMenuItems = !showMenuItems">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;阿杰之家</span>
        </div>
        <transition name="slide">
            <div class="items" v-show="showMenuItems">
                
                <a href="/">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-house fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                    </div>
                </a>
                
                <a href="/about">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-id-card fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                    </div>
                </a>
                
                <a href="/archives">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-box-archive fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                    </div>
                </a>
                
                <a href="/categories">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-bookmark fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                    </div>
                </a>
                
                <a href="/tags">
                    <div class="item">
                        <div style="min-width: 20px; max-width: 50px; width: 10%">
                            <i class="fa-solid fa-tags fa-fw"></i>
                        </div>
                        <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                    </div>
                </a>
                
            </div>
        </transition>
    </div>
</nav>
<transition name="fade">
    <div id="menu-curtain" @click="showMenuItems = !showMenuItems" v-show="showMenuItems"></div>
</transition>

            <transition name="into">
                <div id="main" v-show="!loading">
                    <div id="home-head">
    <div id="home-background" ref="homeBackground" data-images="https://static-argvchs.netlify.app/images/background.jpg"></div>
    <div id="home-info" @click="homeClick">
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="loop"></span>
        <span class="info">
            <div class="wrap">
                <h1>阿杰之家</h1>
                <h3>山有扶苏，隰有荷华</h3>
                <h5>山有扶苏，隰有荷华</h5>
            </div>
        </span>
    </div>
</div>
<div id="home-posts-wrap"  ref="homePostsWrap">
    <div id="home-posts">
        

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Kafka/">
        <h2 class="post-title">SpringBoot整合Kafka</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <p>引入Spring-Kafka的POM依赖</p>
<pre><code class="promql">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;
    &lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>配置<code>application.properties</code>信息</p>
<pre><code class="properties">spring.kafka.bootstrap-servers=10.254.0.2:9092
spring.kafka.consumer.group-id=multiple-consumer-group
spring.kafka.consumer.auto-offset-reset=earliest
</code></pre>
<p>配置Kafka的Topic</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/19 9:49
 */
@Configuration
public class KafkaConfig &#123;

    @Bean
    NewTopic multipleTopic() &#123;
        return TopicBuilder.name(&quot;multiple-topic&quot;).build();
    &#125;

&#125;
</code></pre>
<p>编写KafkaTemplate使用的Service</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/19 10:01
 */
@Slf4j
@Service
public class KafkaServiceImpl implements KafkaService &#123;

    @Resource
    private KafkaTemplate&lt;String, String&gt; kafkaTemplate;

    @Resource
    private CustomListenableFutureCallback futureCallback;

    @Override
    public void send(String topic, String message) &#123;
        try &#123;
            ListenableFuture&lt;SendResult&lt;String, String&gt;&gt; send = kafkaTemplate.send(topic, message);
            send.addCallback(futureCallback);
        &#125; catch (Exception e) &#123;
            e.printStackTrace();
        &#125;
    &#125;
&#125;
</code></pre>
<p>消息发送回调</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/19 14:10
 */
@Slf4j
@Component
public class CustomListenableFutureCallback implements ListenableFutureCallback&lt;SendResult&lt;String, String&gt;&gt; &#123;
    @Override
    public void onFailure(@Nullable Throwable throwable) &#123;
        log.error(&quot;kafka send message error&quot;, throwable);
    &#125;

    @Override
    public void onSuccess(SendResult&lt;String, String&gt; sendResult) &#123;
        log.info(&quot;kafka send message success [&#123;&#125;]&quot;, sendResult);
    &#125;
&#125;
</code></pre>
<p>配置监听</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/19 9:52
 */
@Slf4j
@Component
@KafkaListener(topics = &quot;multiple-topic&quot;)
public class MultipleListening &#123;

    @KafkaHandler
    public void handler(String message) &#123;
        log.info(&quot;kafka listening message [&#123;&#125;]&quot;, message);
    &#125;


    // @KafkaHandler
    public &lt;K, V&gt; void handler0(ConsumerRecord&lt;K, V&gt; record, Acknowledgment ack, @Header(KafkaHeaders.RECEIVED_TOPIC) String topic) &#123;
        log.info(&quot;kafka listening message: topic [&#123;&#125;] key [&#123;&#125;] value [&#123;&#125;]&quot;, topic, record.key(), record.value());
        ack.acknowledge();
    &#125;

&#125;
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Kafka/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Zookeeper%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8/">
        <h2 class="post-title">SpringBoot整合Zookeeper简单运用</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <hr>
<h2 id="title-SpringBoot整合Zookeeper简单运用date-2022-10-11-10-27-30-04updated-2022-10-13-14-43-42-459url-x2F-archives-x2F-spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories-Zookeeper-SpringBoottags-SpringBoot-Zookeeper"><a href="#title-SpringBoot整合Zookeeper简单运用date-2022-10-11-10-27-30-04updated-2022-10-13-14-43-42-459url-x2F-archives-x2F-spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories-Zookeeper-SpringBoottags-SpringBoot-Zookeeper" class="headerlink" title="title: SpringBoot整合Zookeeper简单运用date: 2022-10-11 10:27:30.04updated: 2022-10-13 14:43:42.459url: &#x2F;archives&#x2F;spring-boot-zheng-he-zookeeper-jian-dan-yun-yongcategories:- Zookeeper- SpringBoottags:- SpringBoot- Zookeeper"></a>title: SpringBoot整合Zookeeper简单运用<br>date: 2022-10-11 10:27:30.04<br>updated: 2022-10-13 14:43:42.459<br>url: &#x2F;archives&#x2F;spring-boot-zheng-he-zookeeper-jian-dan-yun-yong<br>categories:<br>- Zookeeper<br>- SpringBoot<br>tags:<br>- SpringBoot<br>- Zookeeper</h2><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>zookeeper一般作为注册中心、配置中心等使用，对于此处的使用，spring cloud zookeeper有非常完善的api，引入相对于的pom即可</p>
<p>而在此处是对zookeeper的基础api进行简单的运用，也就是对zookeeper的节点运用，不涉及集群操作</p>
<pre><code class="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;
  &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://zookeeper.apache.org/">详情参照</a></p>
<h2 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h2><p>zookeeper的节点存储为树形结构，并且其存在多种节点类型，这里只简单使用了持久节点和临时节点<br>持久节点为客户端一经创建，则会永久的存在与本地文件系统，除非客户端手动删除<br>临时节点与客户端的本次连接生命周期一致，连接断掉即自动删除节点，也可手动删除</p>
<p>需要注意的是临时节点下不能存在子节点</p>
<h2 id="代码使用"><a href="#代码使用" class="headerlink" title="代码使用"></a>代码使用</h2><p>属性值</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/10 14:57
 */
@Data
@Configuration
@ConfigurationProperties(prefix = PropertiesPrefixConstant.ZK)
public class ZkProperties &#123;
    private String address;
    private Integer timeout;
&#125;
</code></pre>
<p>配置: 此处的bean配置的为客户端的连接，Zookeeper的客户端对象作为单例存在于IOC容器，维持客户端连接</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/10 15:06
 */
@Configuration
@ConditionalOnProperty(prefix = Constant.CONDITIONAL, name = &quot;zk&quot;, havingValue = &quot;true&quot;)
public class ZookeeperConfig &#123;

    private final static Logger LOGGER = LoggerFactory.getLogger(ZookeeperConfig.class);
    @Resource
    private ZkProperties zkProperties;


    public void test()&#123;

    &#125;

    @Bean
    public ZooKeeper zkClient() &#123;
        ZooKeeper zooKeeper = null;
        try &#123;
            final CountDownLatch countDownLatch = new CountDownLatch(1);
            zooKeeper = new ZooKeeper(zkProperties.getAddress(), zkProperties.getTimeout(), new Watcher() &#123;
                @Override
                public void process(WatchedEvent event) &#123;
                    if (Event.KeeperState.SyncConnected == event.getState()) &#123;
                        countDownLatch.countDown();
                    &#125;
                &#125;
            &#125;);
            countDownLatch.await();
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;zk init client for error&quot;, e);
        &#125;
        return zooKeeper;
    &#125;

&#125;
</code></pre>
<p>API提供者</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/10 15:32
 */
@Component
public class ZkProducer &#123;
    private final static Logger LOGGER = LoggerFactory.getLogger(ZkProducer.class);
    @Resource
    private ZooKeeper zkClient;

    /**
     * 创建永久节点
     *
     * @param path 节点路径
     * @param data 节点的数据
     * @return true创建成功 false创建失败
     */
    public boolean createNode(String path, String data) &#123;
        try &#123;
            if (!existsNode(path)) &#123;
                zkClient.create(path, data.getBytes(StandardCharsets
                        .UTF_8), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
            &#125;
            return true;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;create zk node for error&quot;, e);
        &#125;
        return false;
    &#125;


    /**
     * 创建临时节点
     *
     * @param path 路径
     * @param data 数据
     * @return true创建成功 false创建失败
     */
    public boolean createTmpNode(String path, String data) &#123;
        try &#123;
            if (!existsNode(path)) &#123;
                zkClient.create(path, data.getBytes(StandardCharsets
                        .UTF_8), ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);
            &#125;
            return true;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;create zk tmp node for error&quot;, e);
        &#125;
        return false;
    &#125;

    /**
     * 更新节点数据
     *
     * @param path 节点路径
     * @param data 数据
     * @return true成功 false失败
     */
    public boolean updateNode(String path, String data) &#123;
        try &#123;
            if (existsNode(path)) &#123;
                zkClient.setData(path, data.getBytes(StandardCharsets.UTF_8), -1);
                return true;
            &#125;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;update for zk node data error&quot;, e);
        &#125;
        return false;
    &#125;

    /**
     * 删除节点
     *
     * @param path 节点路径
     * @return true成功 false失败
     */
    public boolean deleteNode(String path) &#123;
        try &#123;
            if (existsNode(path)) &#123;
                zkClient.delete(path, -1);
            &#125;
            return true;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;delete for zk node error&quot;, e);
        &#125;
        return false;
    &#125;

    /**
     * 获取子级节点
     *
     * @param path 节点路径
     * @return 子级结果集合
     */
    public List&lt;String&gt; childrenNode(String path) &#123;
        try &#123;
            return zkClient.getChildren(path, true);
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;obtain node child for error&quot;, e);
        &#125;
        return Collections.emptyList();
    &#125;

    /**
     * 获取节点的数据
     *
     * @param path 节点路径
     * @return 数据
     */
    public String dataGet(String path) &#123;
        try &#123;
            if (existsNode(path)) &#123;
                byte[] data = zkClient.getData(path, true, new Stat());
                return new String(data);
            &#125;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;get zk node on data for error&quot;, e);
        &#125;
        return null;
    &#125;


    /**
     * 判断节点是不是存在
     *
     * @param path zk节点
     * @return true存在 false不存在
     */
    private boolean existsNode(String path) &#123;
        try &#123;
            return zkClient.exists(path, true) != null;
        &#125; catch (Exception e) &#123;
            LOGGER.error(&quot;judge zk node whether exists for error&quot;, e);
        &#125;
        return false;
    &#125;

&#125;
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringBoot%E6%95%B4%E5%90%88Zookeeper%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringCloud%E7%AC%94%E8%AE%B0/">
        <h2 class="post-title">SpringCloud笔记</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h1><p><strong>服务注册中心<code>eureka-server</code></strong></p>
<p>pom支持</p>
<pre><code class="xml"> &lt;dependency&gt;
     &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
     &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8080
eureka.instance.hostname=localhost
#是否注册到服务中心，本身就是注册中
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false
#服务中心的名字地址
eureka.client.service-url.defaultZone=http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/
spring.application.name=eureka-server
</code></pre>
<p>启动类支持<code>@EnableEurekaServer</code></p>
<pre><code class="java">@SpringBootApplication
@EnableEurekaServer
public class SubkeyOneApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(SubkeyOneApplication.class, args);
    &#125;
&#125;
</code></pre>
<p>访问<a href="http://localhost:8080即可看到所有已经注册的服务">http://localhost:8080即可看到所有已经注册的服务</a></p>
<hr>
<p><strong>服务注册</strong></p>
<p>pom支持</p>
<pre><code class="xml"> &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
        &lt;/dependency&gt;
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8081
spring.application.name=zuul-server
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
</code></pre>
<p>启动类支持</p>
<pre><code class="java">@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
</code></pre>
<hr>
<p><strong>负载均衡：<code>Ribbon</code></strong></p>
<p>在使用<code>Ribbon</code>作为负载均衡的时候，需要手动注入一个<code>RestTemplate</code>的Bean到Ioc，并且为该Bean加入<code>@LoadBalanced</code>开启负载均衡，使其能够以查询到服务注册中心的服务。</p>
<p>例如：</p>
<pre><code class="java">@Bean
@LoadBalanced
public RestTemplate getRestTemplate()&#123;
    return new RestTemplate();
&#125;
</code></pre>
<hr>
<p><strong>负载均衡：<code>Feign</code></strong></p>
<p>使用<code>Feign</code>作为负载均衡的时候，需要先在启动类使用<code>@EnableFeignClients</code>来开启，而后创建一个接口，使用<code>@FeignClient(value = &quot;DATA-SERVER&quot;)</code>标签来指定访问的服务</p>
<p>例如：</p>
<pre><code class="java">@FeignClient(value = &quot;DATA-SERVER&quot;)
public interface IProductClientFeign &#123;
    /**
     * 请求数据
     * @return 结果
     */
    @GetMapping(&quot;/product/all&quot;)
    List&lt;Product&gt; allProduct();
&#125;
</code></pre>
<hr>
<p><strong>配置服务<code>ConfigServer</code></strong></p>
<p>pom配置服务包</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>配置文件<code>properties</code>，配置服务参数</p>
<pre><code class="properties">server.port=8030
spring.application.name=config-server
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
spring.cloud.config.label=master
spring.cloud.config.server.git.uri=https://github.com/Huangjie-Github/spring-cloud-config-server
spring.cloud.config.server.git.search-paths=config
spring.cloud.config.server.git.username=Huangjie-Github
spring.cloud.config.server.git.password=h19981228j
</code></pre>
<p>在启动类上开启服务</p>
<pre><code class="java">@EnableEurekaClient
@EnableConfigServer
@EnableDiscoveryClient
</code></pre>
<hr>
<p><strong>使用<code>ConfigServer</code></strong></p>
<p>pom引入服务使用包</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>配置文件中声明配置服务参数</p>
<p><strong>注意：</strong>在使用配置服务的时候，下列参数一定要新建一个bootstrap.properties&#x2F;bootstrap.yml的配置文件，因为bootstrap的配置文件会比application的配置文件先启动加载，需要先启动加载好配置服务才能进行本服务的相关数据注入</p>
<pre><code class="properties">#分支
spring.cloud.config.label=master
#启用的模式
spring.cloud.config.profile=dev
#是否发现启用
spring.cloud.config.discovery.enabled=true
#注册中心的名称
spring.cloud.config.discovery.serviceId=CONFIG-SERVER
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
</code></pre>
<p>配置之后，只需要在引用的类上使用<code>@RefreshScope</code>标签开启，需要引用的参数上使用<code>@Value</code>标签即可</p>
<hr>
<p><strong>消息总线bus：<code>RabbitMQ</code></strong></p>
<p>pom使用jar</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;   
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;
&lt;/dependency&gt; 
</code></pre>
<p>配置文件修改</p>
<p>bootstrap.properties</p>
<pre><code class="properties">#与配置服务绑定
spring.cloud.config.label=master
spring.cloud.config.profile=dev
spring.cloud.config.discovery.enabled=true
spring.cloud.config.discovery.serviceId=CONFIG-SERVER
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
#bus总线配置
spring.cloud.bus.enabled=true
spring.cloud.bus.trace.enabled=true
#配置RabbitMQ
spring.rabbitmq.host=127.0.0.1
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8011
spring.application.name=feign-server
#路线访问允许/actuator/refresh
management.endpoints.web.exposure.include=*
management.endpoints.web.cors.allowed-origins=*
management.endpoints.web.cors.allowed-methods=*
</code></pre>
<p>访问需要更新的微服务<a target="_blank" rel="noopener" href="http://localhost:801/actuator/refresh">http://localhost:801/actuator/refresh</a></p>
<p>该访问不支持Get访问，只支持Post访问</p>
<pre><code class="java">public static void main(String[] args) &#123;
        HashMap&lt;String,String&gt; headers =new HashMap&lt;&gt;();
        headers.put(&quot;Content-Type&quot;, &quot;application/json; charset=utf-8&quot;);
        System.out.println(&quot;因为要去git获取，还要刷新config-server, 会比较卡，所以一般会要好几秒才能完成，请耐心等待&quot;);
 
        String result = HttpUtil.createPost(&quot;http://localhost:8012/actuator/bus-refresh&quot;).addHeaders(headers).execute().body();
        System.out.println(&quot;result:&quot;+result);
        System.out.println(&quot;refresh 完成&quot;);
    &#125;
</code></pre>
<hr>
<p><strong>断路器<code>Hystrix</code></strong></p>
<p>pom支持</p>
<pre><code class="xml">&lt;dependency&gt;
     &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
     &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
&lt;/dependency&gt;   
</code></pre>
<p>原来使用Feign做负载均衡的连接接口类修改其</p>
<pre><code class="java">//原来的
@FeignClient(value = &quot;DATA-SERVER&quot;)
//修改之后的
@FeignClient(value = &quot;DATA-SERVER&quot;,fallback = ProductClientFeignHystrixImpl.class)
</code></pre>
<p><code>fallback</code>：回退，大概就是说，当指定的微服务不可用时，回退到指定类中的复写方法。因为指定的回退类是继承与当前的接口，那么必定需要继承当前的访问抽象方法。所以，在微服务不可用的时候，调用其复写的方法，做微服务不可用处理。</p>
<p>IProductClientFeign.class</p>
<pre><code class="java">@FeignClient(value = &quot;DATA-SERVER&quot;,fallback = ProductClientFeignHystrixImpl.class)
public interface IProductClientFeign &#123;
    /**
     * 请求数据
     * @return 结果
     */
    @GetMapping(&quot;/product/all&quot;)
    List&lt;Product&gt; allProduct();
&#125;
</code></pre>
<p>ProductClientFeignHystrixImpl.class</p>
<pre><code class="java">@Component
public class ProductClientFeignHystrixImpl implements IProductClientFeign &#123;
    @Override
    public List&lt;Product&gt; allProduct() &#123;
        ArrayList&lt;Product&gt; products = new ArrayList&lt;&gt;();
        products.add(new Product(1,&quot;数据服务不可用&quot;,0));
        return products;
    &#125;
&#125;
</code></pre>
<p>配置完断路器之后，还需要去启动类中启用它<code>@EnableHystri</code>，以及去配置文件中开启相关服务操作<code>feign.hystrix.enabled=true</code></p>
<hr>
<p><strong>断路器监听<code>hystrix-dashboard</code></strong></p>
<p>pom支持</p>
<pre><code class="xml">&lt;!--        连接服务注册中心--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!--        断路器监听--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!--        断路器--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!--        环节映射--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>启动类上开启断路器监听</p>
<p><code>@EnableHystrixDashboard</code>：开启断路监听</p>
<pre><code class="java">@SpringBootApplication
@EnableHystrixDashboard
@EnableEurekaClient
public class HystrixMonitorServerApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(HystrixMonitorServerApplication.class, args);
    &#125;
&#125;
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8040
spring.application.name=hystrix-monitor-server
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
</code></pre>
<p>给共享信息让监听器监听的微服务使用<code>@EnableCircuitBreaker</code>开启分享</p>
<pre><code class="java">@SpringBootApplication
@EnableEurekaClient
@EnableFeignClients
@EnableDiscoveryClient
@EnableHystrix
@EnableCircuitBreaker
public class FeignServerApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(FeignServerApplication.class, args);
    &#125;
&#125;
</code></pre>
<p><code>@SpringBootApplication</code>：SpeingBoot启动类<br><code>@EnableEurekaClient</code>：启用微服务注册连接，让注册中心发现，扫描该服务<br><code>@EnableFeignClients</code>：让注册中心发现这个Feign负载均衡的服务<br><code>@EnableDiscoveryClient</code>：<br><code>@EnableHystrix</code>：启用熔断<br><code>@EnableCircuitBreaker</code>：分享信息给熔断监听，本身必须要有熔断机制</p>
<p>访问地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8040/hystrix">http://localhost:8040/hystrix</a></p>
<p>监听地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8011/actuator/hystrix.stream">http://localhost:8011/actuator/hystrix.stream</a></p>
<hr>
<p>断路器聚合监听</p>
<p>pom支持</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-turbine&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8050
spring.application.name=hystrix-turbine-server
eureka.client.service-url.defaultZone=http://localhost:8080/eureka

turbine.aggregator.cluster-config=default
#配置Eureka中的serviceId列表，表明监控哪些服务
turbine.app-config=feign-server
turbine.cluster-name-expression= new String(&quot;default&quot;)
</code></pre>
<p>启动类开启</p>
<pre><code class="java">@SpringBootApplication
@EnableTurbine
@EnableEurekaClient
public class HystrixTurbineServerApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(HystrixTurbineServerApplication.class, args);
    &#125;
&#125;
</code></pre>
<p>使用上面的熔断监听服务去获得监听服务</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8040/hystrix%E3%80%81">http://localhost:8040/hystrix、</a></p>
<p>输入聚合监听的端口地址进行局和监听</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8050/turbine.stream">http://localhost:8050/turbine.stream</a></p>
<hr>
<p><strong>网关<code>zuul</code></strong></p>
<p>pom支持</p>
<pre><code class="xml">&lt;dependency&gt;
     &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
     &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>application.properties</p>
<pre><code class="properties">server.port=8060
spring.application.name=zuul-server
eureka.client.service-url.defaultZone=http://localhost:8080/eureka
#映射
zuul.routes.api-a.path=/api-data/**
zuul.routes.api-a.service-id=DATA-SERVER
zuul.routes.api-b.path=/api-feign/**
zuul.routes.api-b.service-id=FEIGN-SERVER
</code></pre>
<p>启动类开启网关注册<code>@EnableZuulProxy</code></p>
<pre><code class="java">@SpringBootApplication
@EnableEurekaClient
@EnableDiscoveryClient
@EnableZuulProxy
public class ZuulServerApplication &#123;
    public static void main(String[] args) &#123;
        SpringApplication.run(ZuulServerApplication.class, args);
    &#125;
&#125;
</code></pre>
<p>访问地址</p>
<p><a target="_blank" rel="noopener" href="http://localhost:8060/api-feign/feign/all">http://localhost:8060/api-feign/feign/all</a></p>
<hr>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringCloud%E7%AC%94%E8%AE%B0/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringSecurity%E6%95%B4%E5%90%88/">
        <h2 class="post-title">SpringSecurity整合</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <hr>
<h2 id="title-SpringSecurity初体验date-2022-10-13-10-09-19-248updated-2022-10-13-14-40-09-804url-x2F-archives-x2F-springsecurity-chu-ti-yancategories-SpringSecuritytags-SpringSecurity"><a href="#title-SpringSecurity初体验date-2022-10-13-10-09-19-248updated-2022-10-13-14-40-09-804url-x2F-archives-x2F-springsecurity-chu-ti-yancategories-SpringSecuritytags-SpringSecurity" class="headerlink" title="title: SpringSecurity初体验date: 2022-10-13 10:09:19.248updated: 2022-10-13 14:40:09.804url: &#x2F;archives&#x2F;springsecurity-chu-ti-yancategories:- SpringSecuritytags:- SpringSecurity"></a>title: SpringSecurity初体验<br>date: 2022-10-13 10:09:19.248<br>updated: 2022-10-13 14:40:09.804<br>url: &#x2F;archives&#x2F;springsecurity-chu-ti-yan<br>categories:<br>- SpringSecurity<br>tags:<br>- SpringSecurity</h2><p>首先引入pom依赖</p>
<pre><code class="xml">&lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>继承WebSecurityConfigurerAdapter复写如下方法，完成配置</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/12 10:33
 */
@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter &#123;


    @Resource
    private UserService userService;

    @Resource
    private SecurityExcludeUrlProperty securityExcludeUrlProperty;

    /**
     * 自定义的编码密码接口，这里直接返回的明码，demo不做加密编码处理
     *
     * @return 接口实现
     */
    @Bean
    public PasswordEncoder passwordEncoder() &#123;
        return new PasswordEncoder() &#123;
            @Override
            public String encode(CharSequence charSequence) &#123;
                return (String) charSequence;
            &#125;

            @Override
            public boolean matches(CharSequence charSequence, String s) &#123;
                return charSequence.equals(s);
            &#125;
        &#125;;
    &#125;

    /**
     * 配置HttpSecurity
     *
     * @param http HttpSecurity
     * @throws Exception 产生异常
     */
    @Override
    protected void configure(HttpSecurity http) throws Exception &#123;
        http.authorizeRequests()
                .antMatchers(securityExcludeUrlProperty.getUri()).permitAll()
                .anyRequest().authenticated()

                .and()
                .addFilterBefore(new TokenFilter(userService), UsernamePasswordAuthenticationFilter.class)

                .exceptionHandling()
                .accessDeniedHandler(new CustomAccessDeniedHandler())
                .authenticationEntryPoint(new CustomAuthenticationEntryPoint())

                .and().sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).disable()

                .formLogin().disable()
                .logout().disable()
                .csrf().disable();
    &#125;

    /**
     * 用来配置自定义的鉴权操作
     *
     * @param auth 用来配置支持鉴权的构建器
     * @throws Exception 产生异常
     */
    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123;
        super.configure(auth);

        // auth.authenticationProvider(new AuthenticationProvider() &#123;
        //     @Override
        //     public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123;
        //         return null;
        //     &#125;
        //
        //     @Override
        //     public boolean supports(Class&lt;?&gt; authentication) &#123;
        //         return true;
        //     &#125;
        // &#125;);
    &#125;
&#125;
</code></pre>
<p>自定义HttpSecurity之后的调用链路</p>
<blockquote>
<p>Security filter chain:<br>  WebAsyncManagerIntegrationFilter<br>  SecurityContextPersistenceFilter<br>  HeaderWriterFilter<br>  TokenFilter<br>  RequestCacheAwareFilter<br>  SecurityContextHolderAwareRequestFilter<br>  AnonymousAuthenticationFilter<br>  ExceptionTranslationFilter<br>  FilterSecurityInterceptor</p>
</blockquote>
<p>其中TokenFilter为自定义的Filter</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/12 11:00
 */
@Slf4j
public class TokenFilter extends GenericFilterBean &#123;

    private final UserService userService;

    public TokenFilter(UserService userService) &#123;
        this.userService = userService;
    &#125;

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;
        HttpServletRequest request = (HttpServletRequest) servletRequest;
        String authorization = request.getHeader(&quot;Authorization&quot;);
        if (StringUtils.hasLength(authorization))&#123;
            UserDetails userDetails = userService.loadUserByUsername(authorization);
            SecurityContextHolder.getContext().setAuthentication(
                    new UsernamePasswordAuthenticationToken(userDetails.getUsername(), userDetails.getPassword()));
        &#125;
        filterChain.doFilter(servletRequest, servletResponse);
    &#125;
&#125;
</code></pre>
<p>对于用户信息获取需要实现<code>UserDetailsService</code>接口，这里并未对用户信息做复杂操作，只为过登录校验做了处理</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/12 14:02
 */
public interface UserService extends UserDetailsService &#123;

&#125;

/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/12 14:02
 */
@Service
public class UserServiceImpl implements UserService &#123;
    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException &#123;
        UserEntity user = new UserEntity();
        user.setUsername(username);
        user.setPassword(username);
        return user;
    &#125;
&#125;
</code></pre>
<p>其中<code>UserEntity</code>也是实现自UserDetails类</p>
<pre><code class="java">/**
 * @author huangJie
 * @version 1.0v
 * @date 2022/10/12 10:44
 */
@Setter
public class UserEntity implements UserDetails, Serializable &#123;
    private static final long serialVersionUID = 3532830780866118325L;


    private String username;
    private String password;
    private List&lt;String&gt; roles = new ArrayList&lt;String&gt;() &#123;
        private static final long serialVersionUID = 8112282703158213813L;

        &#123;
            add(&quot;ADMIN&quot;);
            add(&quot;USER&quot;);
        &#125;
    &#125;;

    @Override
    public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() &#123;
        List&lt;GrantedAuthority&gt; auth = new ArrayList&lt;&gt;();
        for (String role : roles) &#123;
            auth.add(new SimpleGrantedAuthority(role));
        &#125;
        return auth;
    &#125;

    @Override
    public String getPassword() &#123;
        return password;
    &#125;

    @Override
    public String getUsername() &#123;
        return username;
    &#125;

    @Override
    public boolean isAccountNonExpired() &#123;
        return true;
    &#125;

    @Override
    public boolean isAccountNonLocked() &#123;
        return true;
    &#125;

    @Override
    public boolean isCredentialsNonExpired() &#123;
        return true;
    &#125;

    @Override
    public boolean isEnabled() &#123;
        return true;
    &#125;
&#125;
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/SpringSecurity%E6%95%B4%E5%90%88/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E4%B8%8A%E4%B8%8B%E6%96%87ApplicationContext/">
        <h2 class="post-title">Spring上下文ApplicationContext</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Java-在静态方法中引入bean"><a href="#Java-在静态方法中引入bean" class="headerlink" title="Java 在静态方法中引入bean"></a>Java 在静态方法中引入bean</h1><p>ApplicationContextAware: 相当于在ApplicationContext上下文初始化的时候，会触发的一个钩子，而要想触发就要加入到Bean容器中去进行管理</p>
<pre><code class="java">public class SpringContextUtils implements ApplicationContextAware &#123;
    private static ApplicationContext applicationContext;

    public static void setStatusApplicationContext(ApplicationContext applicationContext) &#123;
        SpringContextUtils.applicationContext = applicationContext;
    &#125;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException &#123;
        SpringContextUtils.setStatusApplicationContext(applicationContext);
    &#125;
    public static &lt;T&gt; T bean(Class&lt;T&gt; clazz) &#123;
        return applicationContext.getBean(clazz);
    &#125;
&#125;
</code></pre>
<p>bean注入</p>
<pre><code class="java">@Bean
public SpringContextUtils springContextUtils()&#123;
    return new SpringContextUtils();
&#125;
</code></pre>
<p>而后只需要在使用的时候使用bean方法，依据类型或者名称等等进行注入即可</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E4%B8%8A%E4%B8%8B%E6%96%87ApplicationContext/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E7%9A%84AOP%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/">
        <h2 class="post-title">Spring的AOP自定义注解</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="自定义注解AOP"><a href="#自定义注解AOP" class="headerlink" title="自定义注解AOP"></a>自定义注解AOP</h1><p><strong>POM文件导入</strong></p>
<p>开启AOP操作</p>
<pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p><strong>创建一个注解</strong></p>
<p>元注解</p>
<ul>
<li>@Documented：用于描述其它类型的annotation应该被作为被标注的程序成员的公共API，因此可以被例如javadoc此类的工具文档化。它是一个标记注解，没有成员。</li>
<li>@Inherited：用于表示某个被标注的类型是被继承的。如果一个使用了@Inherited修饰的annotation类型被用于一个class，则这个annotation将被用于该class的子类。</li>
<li>@Target：用于描述注解的范围，即注解在哪用。它说明了Annotation所修饰的对象范围：Annotation可被用于 packages、types（类、接口、枚举、Annotation类型）、类型成员（方法、构造方法、成员变量、枚举值）、方法参数和本地变量（如循环变量、catch参数）等。取值类型（ElementType）有以下几种：<ul>
<li>CONSTRUCTOR:用于描述构造器</li>
<li>FIELD:用于描述域即类成员变量</li>
<li>LOCAL_VARIABLE:用于描述局部变量</li>
<li>METHOD:用于描述方法</li>
<li>PACKAGE:用于描述包</li>
<li>PARAMETER:用于描述参数</li>
<li>TYPE:用于描述类、接口(包括注解类型) 或enum声明</li>
<li>TYPE_PARAMETER:1.8版本开始，描述类、接口或enum参数的声明</li>
<li>TYPE_USE:1.8版本开始，描述一种类、接口或enum的使用声明</li>
</ul>
</li>
<li>Retention：用于描述注解的生命周期，表示需要在什么级别保存该注解，即保留的时间长短。取值类型（RetentionPolicy）有以下几种：<ul>
<li>SOURCE:在源文件中有效（即源文件保留）</li>
<li>CLASS:在class文件中有效（即class保留）</li>
<li>RUNTIME:在运行时有效（即运行时保留）</li>
</ul>
</li>
</ul>
<pre><code class="java">@Documented
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
public @interface AllowToken &#123;&#125;
</code></pre>
<p><strong>创建AOP切入实现类</strong></p>
<pre><code class="java">@Aspect
@Component
public class TokenAspect &#123;
    //设置切入点
    @Pointcut(value = &quot;@annotation(cn.ajiehome.tools.annotations.AllowToken)&quot;)
    private void pointCut()&#123;&#125;

    @Before(value = &quot;pointCut()&amp;&amp;@annotation(allowToken)&quot;)
    private void before(AllowToken allowToken)&#123;
        //AOP前置通知 advice
        //获取被注解方法的request
        ServletRequestAttributes servletRequestAttributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
        assert servletRequestAttributes != null;
        HttpServletRequest request = servletRequestAttributes.getRequest();
        
        String token = request.getHeader(&quot;token&quot;);
        if (token==null)&#123;
            throw new ApplicationException(CodeType.TOKEN_TIME_OUT);
        &#125;
        //解析token
        DecodedJWT decode = JWT.decode(token);
        //Jwt的头部，由于头部被Base64编码过了，所以需要base64逆解编码
        String header = new String(Base64.getDecoder().decode(decode.getHeader()));
        //Jwt的中间部分，理由同上头部
        String payload = new String(Base64.getDecoder().decode(decode.getPayload()));
        //解析头部
        JSONObject userJson = JSONObject.parseObject(header);
        String id = userJson.getString(&quot;id&quot;);
        String userName = userJson.getString(&quot;userName&quot;);
        //逆解匹配整个Token的编码以及密钥key
        Algorithm algorithm = Algorithm.HMAC256(id);
        try &#123;
            //设置验证条件，这里设置了验证的密钥和编码以及验证的签发人
            JWTVerifier jwtVerifier = JWT.require(algorithm).withIssuer(userName).build();
            //验证是否匹配，如果Token不匹配或者超时，此处将抛出异常
            DecodedJWT verify = jwtVerifier.verify(token);
            //需要的信息获取从头部份获取和中间部分获取
        &#125;catch (Exception e)&#123;

            throw  new ApplicationException(CodeType.TOKEN_TIME_OUT);
        &#125;
    &#125;
    @After(value = &quot;pointCut()&amp;&amp;@annotation(allowToken)&quot;)
    private void after(AllowToken allowToken)&#123;
        //AOP后置通知 advice
    &#125;

    @AfterReturning(value = &quot;pointCut()&amp;&amp; @annotation(allowToken)&quot;,returning = &quot;o&quot;)
    private void alterReturn(AllowToken allowToken,Object o)&#123;
        //AOP返回通知 advice
    &#125;

    @AfterThrowing(value = &quot;pointCut()&amp;&amp;@annotation(allowToken)&quot;)
    private void alterError(AllowToken allowToken)&#123;
        //AOP异常通知 advice
    &#125;
&#125;
</code></pre>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E7%9A%84AOP%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E4%B8%AD%E4%BD%BF%E7%94%A8Bean/">
        <h2 class="post-title">Spring静态方法中使用Bean</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                开源框架
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <hr>
<h2 id="title-Java-在静态方法中引入beandate-2022-04-15-18-27-17-616updated-2022-10-13-15-03-27-631url-x2F-archives-x2F-java-zai-jing-tai-fang-fa-zhong-yin-ru-beancategories-SpringBoottags-SpringBoot"><a href="#title-Java-在静态方法中引入beandate-2022-04-15-18-27-17-616updated-2022-10-13-15-03-27-631url-x2F-archives-x2F-java-zai-jing-tai-fang-fa-zhong-yin-ru-beancategories-SpringBoottags-SpringBoot" class="headerlink" title="title: Java 在静态方法中引入beandate: 2022-04-15 18:27:17.616updated: 2022-10-13 15:03:27.631url: &#x2F;archives&#x2F;java-zai-jing-tai-fang-fa-zhong-yin-ru-beancategories:- SpringBoottags:- SpringBoot"></a>title: Java 在静态方法中引入bean<br>date: 2022-04-15 18:27:17.616<br>updated: 2022-10-13 15:03:27.631<br>url: &#x2F;archives&#x2F;java-zai-jing-tai-fang-fa-zhong-yin-ru-bean<br>categories:<br>- SpringBoot<br>tags:<br>- SpringBoot</h2><p>ApplicationContextAware: 相当于在ApplicationContext上下文初始化的时候，会触发的一个钩子，而要想触发就要加入到Bean容器中去进行管理</p>
<pre><code class="java">public class SpringContextUtils implements ApplicationContextAware &#123;
    private static ApplicationContext applicationContext;

    public static void setStatusApplicationContext(ApplicationContext applicationContext) &#123;
        SpringContextUtils.applicationContext = applicationContext;
    &#125;

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException &#123;
        SpringContextUtils.setStatusApplicationContext(applicationContext);
    &#125;
    public static &lt;T&gt; T bean(Class&lt;T&gt; clazz) &#123;
        return applicationContext.getBean(clazz);
    &#125;
&#125;
</code></pre>
<p>bean注入</p>
<pre><code class="java">@Bean
public SpringContextUtils springContextUtils()&#123;
    return new SpringContextUtils();
&#125;
</code></pre>
<p>而后只需要在使用的时候使用bean方法，依据类型或者名称等等进行注入即可</p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E5%BC%80%E6%BA%90%E6%A1%86%E6%9E%B6/Spring%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E4%B8%AD%E4%BD%BF%E7%94%A8Bean/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos7%E5%AE%89%E8%A3%85Wordpress/">
        <h2 class="post-title">Centos7安装Wordpress</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                操作系统
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Centos7安装Wordpress以及环境"><a href="#Centos7安装Wordpress以及环境" class="headerlink" title="Centos7安装Wordpress以及环境"></a>Centos7安装Wordpress以及环境</h1><h2 id="一、安装MySQL57版本"><a href="#一、安装MySQL57版本" class="headerlink" title="一、安装MySQL57版本"></a>一、安装MySQL57版本</h2><p><strong>1、从MySQL官网下载YUM源的RPM安装包</strong></p>
<pre><code class="shell">wget http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm
</code></pre>
<p><strong>2、从下载好的rpm包安装MYSQL</strong></p>
<pre><code class="shell">yum localinstall mysql57-community-release-el7-8.noarch.rpm
</code></pre>
<p><strong>3、安装MySQL服务</strong></p>
<pre><code class="shell">yum install mysql-community-server
</code></pre>
<p><strong>4、启动MySQL服务</strong></p>
<pre><code class="shell">systemctl start mysqld.service
</code></pre>
<p><strong>5、设置开机自启并且刷新</strong></p>
<pre><code class="shell">systemctl enable mysqld
systemctl daemon-reload
</code></pre>
<p><strong>6、修改默认初始化密码-&gt;由于密码策略所以只能设置较为复杂的密码</strong></p>
<pre><code class="shell">#临时密码在/var/log/mysqld.log
alter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;ZhonHua@5000Nian&#39;;
</code></pre>
<p><strong>7、查看MySQL的密码安全策略</strong></p>
<pre><code class="shell">show variables like &#39;validate_password%&#39;;
</code></pre>
<p><img src="/./images/MYSQL%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5.PNG" alt="img"></p>
<p><strong>8、修改密码杂度为最低以及把密码长度改为自己想要的</strong></p>
<pre><code class="shell">set global validate_password_policy = LOW;
set global validate_password_length = 6;
</code></pre>
<p><img src="/./images/MySQL%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81%E7%AD%96%E7%95%A5.PNG" alt="img"></p>
<p><strong>9、修改为自己想要的密码</strong></p>
<pre><code class="shell">alter user &#39;root&#39;@&#39;localhost&#39; identified by &#39;123456&#39;;
</code></pre>
<p><strong>10、创建wordpress数据库</strong></p>
<pre><code class="shell">create database wordpress;
</code></pre>
<p><strong>11、允许远程登陆然后刷新</strong></p>
<pre><code class="shell">grant all on *.* to root@&#39;%&#39; identified by &#39;password&#39; with grant option;
flush privileges;
</code></pre>
<p><strong>12、重启MySQL服务</strong></p>
<pre><code class="shell">systemctl restart mysqld.service
</code></pre>
<p><strong>13、密码忘记或者策略失败</strong></p>
<pre><code class="shell">#关闭密码验证策略，url：vi /root/my.cnf
skip-grant-tables
#修改mysql.user表的密码
update mysql.user set authentication_string=password(&#39;新密码&#39;) where user=&#39;root&#39; ;
#刷新
flush privileges ;
#然后删除skip-grant-tables之后重启MySQL服务
</code></pre>
<h2 id="二、安装apache-gt-httpd"><a href="#二、安装apache-gt-httpd" class="headerlink" title="二、安装apache-&gt;httpd"></a>二、安装apache-&gt;httpd</h2><p><strong>1、安装httpd</strong></p>
<pre><code class="shell">yum install httpd
</code></pre>
<p><strong>2、启动httpd服务</strong></p>
<pre><code class="shell">systemctl start httpd.service
</code></pre>
<p><strong>3、设置成开机自启并且刷新</strong></p>
<pre><code class="shell">systemctl enable httpd.service
systemctl daemon-reload
</code></pre>
<h2 id="三、安装php-gt-及相关驱动"><a href="#三、安装php-gt-及相关驱动" class="headerlink" title="三、安装php-&gt;及相关驱动"></a>三、安装php-&gt;及相关驱动</h2><p><strong>1、安装php、php-fpm、php-mysql</strong></p>
<pre><code class="shell">yum install php php-fpm php-mysql
</code></pre>
<p><strong>2、启动php-fpm服务</strong></p>
<pre><code class="shell">systemctl start php-fpm.service
</code></pre>
<p><strong>3、设置成开机自启并且刷新</strong></p>
<pre><code class="shell">systemctl enable php-fpm.service
systemctl daemon-reload
</code></pre>
<h2 id="四、查看三个服务的运行状态"><a href="#四、查看三个服务的运行状态" class="headerlink" title="四、查看三个服务的运行状态"></a>四、查看三个服务的运行状态</h2><p><strong>httpd监听80端口，mysql监听3306端口，php-fpm监听9000端口</strong></p>
<pre><code class="shell">netstat -tunlp
</code></pre>
<h2 id="五、安装wordpress官网tar-gz安装包"><a href="#五、安装wordpress官网tar-gz安装包" class="headerlink" title="五、安装wordpress官网tar.gz安装包"></a>五、安装wordpress官网tar.gz安装包</h2><p><strong>2、用wget获取wordpress安装包</strong></p>
<pre><code class="shell">wget https://ww.wp.xz.cn/wordpress-4.5.20.tar.gz
</code></pre>
<p><strong>3、解压安装包到&#x2F;var&#x2F;www路径下</strong></p>
<pre><code class="shell">tar -zxf wordpress-4.5.20.tar.gz -C /var/www
</code></pre>
<p><strong>4、修改httpd的配置文件把默认的映射路径改为&#x2F;var&#x2F;www&#x2F;wordpress</strong>  </p>
<pre><code class="shell">vi  /etc/httpd/conf/httpd.conf
# DocumentRoot的值

**5、保存修改文件退出后重新启动httpd服务**

```shell
systemctl restart httpd.service
</code></pre>
<p><strong>6、把wordpress目录赋予apache所有权限</strong></p>
<pre><code class="shell">chown -R apache:apache /var/www/wordpress
</code></pre>
<h2 id="六、用浏览器启动绑定服务器的域名或者服务器的IP然后就可以开始配置相关的数据"><a href="#六、用浏览器启动绑定服务器的域名或者服务器的IP然后就可以开始配置相关的数据" class="headerlink" title="六、用浏览器启动绑定服务器的域名或者服务器的IP然后就可以开始配置相关的数据"></a>六、用浏览器启动绑定服务器的域名或者服务器的IP然后就可以开始配置相关的数据</h2>
            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos7%E5%AE%89%E8%A3%85Wordpress/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos7%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">
        <h2 class="post-title">Centos7常用命令</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                操作系统
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Centos7常用命令"><a href="#Centos7常用命令" class="headerlink" title="Centos7常用命令"></a>Centos7常用命令</h1><p><strong>防火墙相关命令</strong></p>
<ul>
<li><p>防火墙的开启、关闭、重启、与状态</p>
<pre><code class="shell"> #开启
 systemctl start   firewalld.service
 #关闭
 systemctl stop    firewalld.service
 #重启
 systemctl restart firewalld.service
 #状态
 systemctl status  firewalld.service
 #设置开机自启
 systemctl enable  firewalld.service
 #关闭开机自启
 systemctl disable firewalld.service
 
 #指定IP放行指定端口
 firewall-cmd --permanent --add-rich-rule=&quot;rule family=&quot;ipv4&quot; source address=&quot;192.168.142.166&quot; port protocol=&quot;tcp&quot; port=&quot;5432&quot; accept&quot;
</code></pre>
</li>
<li><p>查看所有公开项目</p>
<pre><code class="shell"> #查看所有公开项
 firewall-cmd --list-all
 #查看端口是否放行
 firewall-cmd --zone=public --query-port=80/tcp
</code></pre>
</li>
<li><p>防火墙放行端口或服务</p>
<pre><code class="shell"> #添加放行端口
 firewall-cmd --zone=public --add-port=80/tcp --permanent
 #重新加载所有的设置项
 firewall-cmd --reload
</code></pre>
<pre><code class="shell">  #添加放行服务
  firewall-cmd --zone=public --add-service=http --permanent
  firewall-cmd --reload
</code></pre>
</li>
<li><p>防火墙移除放行端口或服务</p>
<pre><code class="shell"> #移除已经放行的端口
 firewall-cmd --zone=public --remove-port=80/tcp
 firewall-cmd --reload
</code></pre>
<pre><code class="shell">  #移除已经放行服务
  firewall-cmd --zone=public --remove-service=http
  firewall-cmd --reload
</code></pre>
</li>
</ul>
<p><strong>端口操作</strong></p>
<ul>
<li><p>端口占用查询</p>
<pre><code class="shell"> netstat -tunlp | grep &#39;port&#39;
 ----------------------------------------------------------------------------------
 -t (tcp) 仅显示tcp相关选项
 -u (udp) 仅显示udp相关选项
 -n 拒绝显示别名，能显示数字的全部转化为数字
 -l 仅列出在Listen(监听)的服务状态
 -p 显示建立相关链接的程序名
</code></pre>
<pre><code class="shell"> lsof -i:&#39;port&#39;
</code></pre>
</li>
<li><p>端口终结</p>
<pre><code class="shell"> kill -9 &#39;pid&#39;
</code></pre>
</li>
</ul>
<p><strong>服务操作</strong></p>
<ul>
<li><p>服务状态查询</p>
<pre><code class="shell">  systemctl status &#39;serverName&#39;
</code></pre>
</li>
<li><p>服务开启</p>
<pre><code class="shell">  sysyemctl start &#39;serverName&#39;
</code></pre>
</li>
<li><p>服务关闭</p>
<pre><code class="shell"> systemctl stop &#39;serverName&#39;
</code></pre>
</li>
<li><p>服务自启</p>
<pre><code class="shell">  systemctl enable &#39;serverName&#39;
</code></pre>
</li>
<li><p>关闭服务自启</p>
<pre><code class="shell"> systemctl disable &#39;serverName&#39;
</code></pre>
</li>
</ul>
<p><strong>用户和组</strong></p>
<ul>
<li><p>用户和组</p>
<pre><code class="shell">  #添加用户
  adduser &#39;userName&#39;
</code></pre>
<pre><code class="shell">#新建工作组
groupadd &#39;groupName&#39;
</code></pre>
<pre><code class="shell">#添加用户，并且把把用户添加到指定名称的组
useradd -g &#39;groupName&#39; &#39;userName&#39;
</code></pre>
<pre><code class="shell">#给已有用户添加到工作组
usermod -G &#39;groupName&#39; &#39;userName&#39;
gpasswd -a &#39;userName&#39; &#39;groupName&#39;
</code></pre>
<pre><code class="shell">#临时锁定用户的密码，使账户失效
passwd &#39;userName&#39; -l
#把临时锁定密码的用户开发，使账户重新有效
passwd &#39;userName&#39; -u
</code></pre>
<pre><code class="shell">#永久删除用户
userdel &#39;userName&#39;
#永久删除组
groupdel &#39;groupName&#39;
#同时删除用户和组
usermod -G &#39;userName&#39; &#39;groupName&#39;
#从指定的组中删除指定的用户
gpassed -d &#39;userName&#39; &#39;groupName&#39;
</code></pre>
<pre><code class="shell">#显示用户信息
id &#39;userName&#39;
#将用户添加到指定组
usermod -G &#39;groupName&#39; &#39;userName&#39;
#修改用户userName1的名称为userName2
usermod -l &#39;userName2&#39; &#39;userName1&#39;
#锁定账户
usermod -L &#39;userName&#39;
#解除用户锁定
usermod -U &#39;userName&#39;
</code></pre>
</li>
</ul>
<hr>
<p><strong>持续更新中…</strong></p>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos7%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="go-post">阅读全文</a>
</div>

<div class="post">
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/">
        <h2 class="post-title">Centos创建虚拟内存</h2>
    </a>
    <div class="category-and-date">
        
        <span class="category">
            <a href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                操作系统
            </a>
        </span>
        
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/6/7
        </span>
        
        
    </div>
    <div class="description">
        <div class="content" v-pre>
            
            <h1 id="Linux创建虚拟内存"><a href="#Linux创建虚拟内存" class="headerlink" title="Linux创建虚拟内存"></a>Linux创建虚拟内存</h1><ol>
<li>创建swap文件夹，一般在根目录就好，swap通常代表虚拟内存</li>
<li>创建swapfile文件，swapfile为伪装成内存的文件<pre><code class="shell"> dd if=/dev/zero of=/swap/swapfile bs=1G count=4096
</code></pre>
</li>
<li>将swapfile文件设置为swap分区文件<pre><code class="shell"> mkswap /swap/swapfile
</code></pre>
</li>
<li>激活swap区，并立即启用交换区文件<pre><code class="shell"> swapon /swap/swapfile
</code></pre>
</li>
<li>设置开机自启需要在<code>/etc/fstab</code>文件的末尾添加一行命令<pre><code class="shell">/swap/swapfile swap swap defaults 0 0
</code></pre>
</li>
</ol>

            
        </div>
    </div>
    <div class="post-tags">
        
        
    </div>
    <a href="/2023/06/07/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Centos%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/" class="go-post">阅读全文</a>
</div>


        <div class="page-current">
    <div class="prev">
        
        <a class="page-num" href="/page/4/">
            <i class="fa-solid fa-caret-left fa-fw"></i>
        </a>
        
    </div>
    <div class="page-index">
        
        <span>
            
            <a class="page-num" href="/">1</a>
            <span class="page-omit">...</span>
            
            
            
            
            <a class="page-num" href="/page/3">3</a>
            
            
            <a class="page-num" href="/page/4/">4</a>
        </span>
        
        <span class="current">5</span>
        
        <span>
            <a class="page-num" href="/page/6/">6</a>
            
            <a class="page-num" href="/page/7">7</a>
            
            
            <span class="page-omit">...</span>
            <a class="page-num" href="/page/9">9</a>
            
        </span>
        
    </div>
    <div class="next">
        
        <a class="page-num" href="/page/6/">
            <i class="fa-solid fa-caret-right fa-fw"></i>
        </a>
        
    </div>
</div>

    </div>
    
    <div id="home-card">
        <div id="card-div">
    <div class="card-style">
        <div class="avatar">
            <img src="https://static-argvchs.netlify.app/images/avatar.jpg" alt="avatar" />
        </div>
        <div class="name">ajiehome</div>
        <div class="description">
            <p>Here’s an argvchs…</p>

        </div>
        
        <div class="icon-links">
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://github.com/argvchs">
                    <i
                        class="fa-brands fa-github fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&uin=3364555156&site=qq&menu=yes">
                    <i
                        class="fa-brands fa-qq fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a target="_blank" rel="noopener" href="https://twitter.com/argvchs">
                    <i
                        class="fa-brands fa-twitter fa-fw"
                    ></i>
                </a>
            </span>
            
            <span class="icon-link">
                <a href="mailto:argvchs@outlook.com">
                    <i
                        class="fa-solid fa-envelope fa-fw"
                    ></i>
                </a>
            </span>
            
        </div>
        
        
        <div class="friend-links">
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://blog.yuzi.dev">Yuzi</a>
            </div>
            
            <div class="friend-link">
                <a target="_blank" rel="noopener" href="https://lynxcatthethird.github.io">LynxCatTheThird</a>
            </div>
            
        </div>
        
    </div>
</div>

    </div>
    
</div>

                    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 阿杰之家
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;ajiehome
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/theme-particlex/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

                </div>
            </transition>
            
            <transition name="fade">
                <div id="preview" ref="preview" v-show="previewShow">
                    <img id="preview-content" ref="previewContent" />
                </div>
            </transition>
            
        </div>
        <script src="/js/main.js"></script>
        <script>
            console.info("Welcome to Argvchs' blog!");
            if (!window.hasOwnProperty("ontouchstart")) {
                let html = '<canvas id="fireworks" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 32767"></canvas><script src="https://static-argvchs.netlify.app/js/fireworks.min.js"><\/script>';
                document.body.append(document.createRange().createContextualFragment(html));
            }
        </script>
        
    </body>
</html>
