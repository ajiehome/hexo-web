---
title: Centos定时任务Crontabs
date: 2023-06-07 15:58:40
tags:
categories: 
- 操作系统
---
# crontabs-定时执行执行sh

首先安装crontabs工具

```shell
yum install crontabs
```

安装完之后，系统默认安装了`crond`服务，`crond`默认是自启状态

`crond`的执行方式为每一分钟扫描本地是否有需要执行的事务

`crontab` 命令。该命令和 at 命令类似，也是通过 `/etc/cron.allow `和 `/etc/cron.deny` 文件来限制某些用户是否可以使用 crontab 命令的。

| 功能    | 选项                                                         |
| ------- | ------------------------------------------------------------ |
| -u user | 用来选择某个用户的crontab服务，如-u demo，则运行demo用户的crontab服务，一般默认root用户 |
| -e      | 编辑某个用户的crontab文件内容，如果不指定用户，则默认编辑当前用户的crontab文件 |
| -l      | 显示某个用户的crontab文件内容，如果不指定用户，则默认编辑当前用户的crontab文件 |
| -r      | 从/var/spool/cron中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件 |
| -i      | 删除用户的crontab文件是给予提示                              |

例如：

```shell
crontab -e
# 进入crontab文件显示当前用户的所有内容
# 如下所示
# * * * * * /root/test.sh >> /root/log.log
```

crontab的定时执行任务是通过`*`来进行确认时间的

| 项目      | 含义                           | 范围                    |
| --------- | ------------------------------ | ----------------------- |
| 第一个`*` | 一小时当中的第几分钟（minute） | 0~59                    |
| 第二个`*` | 一天当中的第几小时（hour）     | 0~23                    |
| 第三个`*` | 一个月当中的第几天（day）      | 1~31                    |
| 第四个`*` | 一年当中的第几个月（month）    | 1~12                    |
| 第五个`*` | 一周当中的星期几（week）       | 0~7（0和7都代表星期日） |

在时间表示中还有一些符号含有特殊含义

| 符号 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| *    | 表任何时间。比如第一个"*"就代表一小时中<br />每分钟都执行一次的意思。 |
| ,    | 代表不连续的时间。比如"0 8，12，16***"命令就代表在每<br />天的8点0分、12点0分、16点0分都执行一次命令 |
| -    | 代表连续的时间范围。比如"0 5 ** 1-6"命令<br />代表在周一到周六的凌晨5点0分执行命令。 |
|/|代表每隔多久执行一次。比如"*/10****命令"<br />代表每隔 10 分钟就执行一次命令。

例如：

```shell
# 每五分钟执行一次
*/5 * * * * /root/test.sh >> /root/log.log
# 每一分钟执行一次
* * * * * /root/test.sh >> /root/log.log
# 没五分钟往log里面写入11
*/5 * * * * /bin/echo "11" >> /root/log.log
```

| 时间            | 含义                                                         |
| --------------- | ------------------------------------------------------------ |
| `45 22 * * *`   | 在 22 点 45 分执行命令                                       |
| `0 17 * * 1`    | 在每周一的 17 点 0 分执行命令                                |
| `0 5 1，15 * *` | 在每月1日和15日的凌晨 5 点 0 分执行命令                      |
| `40 4 * * 1-5`  | 在每周一到周五的凌晨 4 点 40 分执行命令                      |
| `*/10 4 * * *`  | 在每天的凌晨 4 点，每隔 10 分钟执行一次命令                  |
| `0 0 1，15 * 1` | 在每月1日和15日，每周一个0点0分都会执行命令<br />注意：星期几和几日最好不要同时出现，因为它们定义的都是天，非常容易让管理员混淆 |

*注意*：每个用户都可以执行自己的crontab任务